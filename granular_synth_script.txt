{***************************************************
Granular Kalimba Script
Author: Miguel González del Río
Finished: 4th August, 2025
****************************************************}

on init
    load_performance_view( "perfView.nckp" )
    {message( "Granular Kalimba Loaded" )}
    set_script_title( "Granular Synth Script" )

    set_snapshot_type( 1 ) {0 = load the entire init callback, 1 = loads only the on persistence_changed callback}


    {Useful Variables}
    declare const $ui_wait := 1500000
    declare %callback_ids[100]



    {Background Animation Declaration}
    declare ui_slider $animation(0,124)
    set_control_par( get_ui_id( $animation ), $CONTROL_PAR_Z_LAYER, -1 )
    set_control_par(get_ui_id($animation), $CONTROL_PAR_POS_X, 390)
    set_control_par(get_ui_id($animation), $CONTROL_PAR_POS_Y, 50)
    set_control_par_str(get_ui_id($animation), $CONTROL_PAR_PICTURE, "animation")
    set_listener($NI_SIGNAL_TIMER_MS, 15000) {25 frames per second}




    {Group Declarations}
    declare $instrument_number := 10
    declare $a
    declare $b

    declare %group[20]
    %group[0] := 0              {Kalimba Group}
    %group[1] := 1              {Reverse Kalimba Group}
    %group[2] := 2              {Rain Effect Group}
    %group[3] := 3              {Reverse Rain Effect Group}
    %group[4] := 4              {Native American Flute Group}
    %group[5] := 5              {Reverse Native American Flute Group}
    %group[6] := 6              {Guitar Group}
    %group[7] := 7              {Reverse Guitar Group}
    %group[8] := 8              {Saw Pluck Group}
    %group[9] := 9              {Reverse Saw Pluck Group}
    %group[10] := 10            {Vocal Group}
    %group[11] := 11            {Reverse Vocal Group}
    %group[12] := 12            {Piano Group}
    %group[13] := 13            {Reverse Piano Group}
    %group[14] := 14            {Ethereal Group}
    %group[15] := 15            {Reverse Ethereal Group}
    %group[16] := 16            {Sine Pluck Group}
    %group[17] := 17            {Reverse Sine Pluck Group}
    %group[18] := 18            {Water Drop Group}
    %group[19] := 19            {Reverse Water Drop Group}
 
    declare %instrument_active[10]
    %instrument_active[0] := 1  {Kalimba Active}
    %instrument_active[1] := 0  {Rain Effect Active}
    %instrument_active[2] := 0  {Native American Flute Active}
    %instrument_active[3] := 0  {Guitar Active}
    %instrument_active[4] := 0  {Saw Pluck Active}
    %instrument_active[5] := 0  {Vocal Active}
    %instrument_active[6] := 0  {Piano Active}
    %instrument_active[7] := 0  {Ethereal Active}
    %instrument_active[8] := 0  {Sine Pluck Active}
    %instrument_active[9] := 0  {Water Drop Active}

    declare %instrument_reverse[10]
    %instrument_reverse[0] := 0  {Kalimba Reverse}
    %instrument_reverse[1] := 0  {Rain Effect Reverse}
    %instrument_reverse[2] := 0  {Native American Flute Reverse}
    %instrument_reverse[3] := 0  {Guitar Reverse}
    %instrument_reverse[4] := 0  {Saw Pluck Reverse}
    %instrument_reverse[5] := 0  {Vocal Reverse}
    %instrument_reverse[6] := 0  {Piano Reverse}
    %instrument_reverse[7] := 0  {Ethereal Reverse}
    %instrument_reverse[8] := 0  {Sine Pluck Reverse}
    %instrument_reverse[9] := 0  {Water Drop Reverse}

    declare %instrument_position[10]
    %instrument_position[0] := 0 {Kalimba Position}
    %instrument_position[1] := 0 {Rain Effect Position}
    %instrument_position[2] := 0 {Native American Flute Position}
    %instrument_position[3] := 0 {Guitar Position}
    %instrument_position[4] := 0 {Saw Pluck Position}
    %instrument_position[5] := 0 {Vocal Position}
    %instrument_position[6] := 0 {Piano Position}
    %instrument_position[7] := 0 {Ethereal Position}
    %instrument_position[8] := 0 {Sine Pluck Position}
    %instrument_position[9] := 0 {Water Drop Position}

    declare ?instrument_position_randomness[10]
    ?instrument_position_randomness[0] := 0.0 {Kalimba Position Randomness}
    ?instrument_position_randomness[1] := 0.0 {Rain Effect Position Randomness}
    ?instrument_position_randomness[2] := 0.0 {Native American Flute Position Randomness}
    ?instrument_position_randomness[3] := 0.0 {Guitar Position Randomness}
    ?instrument_position_randomness[4] := 0.0 {Saw Pluck Position Randomness}
    ?instrument_position_randomness[5] := 0.0 {Vocal Position Randomness}
    ?instrument_position_randomness[6] := 0.0 {Piano Position Randomness}
    ?instrument_position_randomness[7] := 0.0 {Ethereal Position Randomness}
    ?instrument_position_randomness[8] := 0.0 {Sine Pluck Position Randomness}
    ?instrument_position_randomness[9] := 0.0 {Water Drop Position Randomness}


    declare $height := 10
    {Kalimba Group}
    declare ui_button $kalimba_toggle_button                    {Button to toggle kalimba}
    set_control_par( get_ui_id( $kalimba_toggle_button ), $CONTROL_PAR_WIDTH, 50 )
    set_control_par_str( get_ui_id( $kalimba_toggle_button ), $CONTROL_PAR_TEXT, "Kalimba" )
    declare ui_button $kalimba_reverse_button                   {Button to toggle reversed grains}
    set_control_par( get_ui_id( $kalimba_reverse_button ), $CONTROL_PAR_WIDTH, 55 )
    set_control_par_str( get_ui_id( $kalimba_reverse_button ), $CONTROL_PAR_TEXT, "Reversed" )

    declare ui_slider $kalimba_position(0, 1000000 )            {kalimba_position slider for grain playback}
    declare ui_label $kalimba_position_label( 1, 1 )
        set_control_par_str( get_ui_id( $kalimba_position_label ), $CONTROL_PAR_TEXT, "POSITION" ) 

    declare ui_slider $kalimba_position_random(0, 1000000 )     {kalimba_position slider for grain playback}
    declare ui_label $kalimba_position_random_label( 1, 1 )
        set_control_par_str( get_ui_id( $kalimba_position_random_label ), $CONTROL_PAR_TEXT, "RANDOM" )

    declare ui_slider $kalimba_volume(0, 1000000)                  {Volume knob for Kalimba}
    declare ui_label $kalimba_volume_label( 1, 1 )
        set_control_par_str( get_ui_id( $kalimba_volume_label ), $CONTROL_PAR_TEXT, "VOLUME" )

    declare ui_panel $kalimba_panel
    set_control_par( get_ui_id( $kalimba_panel ), $CONTROL_PAR_POS_X, 30 )
    set_control_par( get_ui_id( $kalimba_panel ), $CONTROL_PAR_POS_Y, 0 + $height )

    set_control_par( get_ui_id( $kalimba_toggle_button ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $kalimba_panel ) )
    set_control_par( get_ui_id( $kalimba_toggle_button ), $CONTROL_PAR_POS_X, 0 )
    set_control_par( get_ui_id( $kalimba_toggle_button ), $CONTROL_PAR_POS_Y, 25 )

    set_control_par( get_ui_id( $kalimba_reverse_button ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $kalimba_panel ) )
    set_control_par( get_ui_id( $kalimba_reverse_button ), $CONTROL_PAR_POS_X, 60 )
    set_control_par( get_ui_id( $kalimba_reverse_button ), $CONTROL_PAR_POS_Y, 25 )
    
    set_control_par( get_ui_id( $kalimba_position ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $kalimba_panel ) )
    set_control_par( get_ui_id( $kalimba_position ), $CONTROL_PAR_POS_X, 155 )
    set_control_par( get_ui_id( $kalimba_position ), $CONTROL_PAR_POS_Y, 15 )

    set_control_par( get_ui_id( $kalimba_position_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $kalimba_panel ) )
    hide_part( $kalimba_position_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $kalimba_position_label ), $CONTROL_PAR_POS_X, 146)
    set_control_par( get_ui_id( $kalimba_position_label ), $CONTROL_PAR_POS_Y, 50 )

    set_control_par( get_ui_id( $kalimba_position_random ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $kalimba_panel ) )
    set_control_par( get_ui_id( $kalimba_position_random ), $CONTROL_PAR_POS_X, 225 )
    set_control_par( get_ui_id( $kalimba_position_random ), $CONTROL_PAR_POS_Y, 15 )

    set_control_par( get_ui_id( $kalimba_position_random_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $kalimba_panel ) )
    hide_part( $kalimba_position_random_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $kalimba_position_random_label ), $CONTROL_PAR_POS_X, 216)
    set_control_par( get_ui_id( $kalimba_position_random_label ), $CONTROL_PAR_POS_Y, 50 )

    set_control_par( get_ui_id( $kalimba_volume ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $kalimba_panel ) )
    set_control_par( get_ui_id( $kalimba_volume ), $CONTROL_PAR_POS_X, 295 )
    set_control_par( get_ui_id( $kalimba_volume ), $CONTROL_PAR_POS_Y, 15 )

    set_control_par( get_ui_id( $kalimba_volume_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $kalimba_panel ) )
    hide_part( $kalimba_volume_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $kalimba_volume_label ), $CONTROL_PAR_POS_X, 286)
    set_control_par( get_ui_id( $kalimba_volume_label ), $CONTROL_PAR_POS_Y, 50 )

    {Rain Stick Group}
    declare ui_button $rain_stick_toggle_button
    set_control_par( get_ui_id( $rain_stick_toggle_button ), $CONTROL_PAR_WIDTH, 60 )
    set_control_par_str( get_ui_id( $rain_stick_toggle_button ), $CONTROL_PAR_TEXT, "Rain Stick" )

    declare ui_button $rain_stick_reverse_button
    set_control_par( get_ui_id( $rain_stick_reverse_button ), $CONTROL_PAR_WIDTH, 55 )
    set_control_par_str( get_ui_id( $rain_stick_reverse_button ), $CONTROL_PAR_TEXT, "Reversed" )

    declare ui_slider $rain_stick_position(0, 1000000 )         { slider for grain playback}
    declare ui_label $rain_position_label( 1, 1 )
        set_control_par_str( get_ui_id( $rain_position_label ), $CONTROL_PAR_TEXT, "POSITION" )

    declare ui_slider $rain_stick_position_random(0, 1000000 )         {kalimba_position slider for grain playback}
    declare ui_label $rain_stick_position_random_label( 1, 1 )
        set_control_par_str( get_ui_id( $rain_stick_position_random_label ), $CONTROL_PAR_TEXT, "RANDOM" )

    declare ui_slider $rain_stick_volume(0, 1000000)                  {Volume knob for Rain Stick}
    declare ui_label $rain_stick_volume_label( 1, 1 )
        set_control_par_str( get_ui_id( $rain_stick_volume_label ), $CONTROL_PAR_TEXT, "VOLUME" )

    declare ui_panel $rain_stick_panel
    set_control_par( get_ui_id( $rain_stick_panel ), $CONTROL_PAR_POS_X, 630 )
    set_control_par( get_ui_id( $rain_stick_panel ), $CONTROL_PAR_POS_Y, 190 )

    set_control_par( get_ui_id( $rain_stick_toggle_button ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $rain_stick_panel ) )
    set_control_par( get_ui_id( $rain_stick_toggle_button ), $CONTROL_PAR_POS_X, 5 )
    set_control_par( get_ui_id( $rain_stick_toggle_button ), $CONTROL_PAR_POS_Y, 25 )

    set_control_par( get_ui_id( $rain_stick_reverse_button ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $rain_stick_panel ) )
    set_control_par( get_ui_id( $rain_stick_reverse_button ), $CONTROL_PAR_POS_X, 70 )
    set_control_par( get_ui_id( $rain_stick_reverse_button ), $CONTROL_PAR_POS_Y, 25 )

    set_control_par( get_ui_id( $rain_stick_position ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $rain_stick_panel ) )
    set_control_par( get_ui_id( $rain_stick_position ), $CONTROL_PAR_POS_X, 165 )
    set_control_par( get_ui_id( $rain_stick_position ), $CONTROL_PAR_POS_Y, 15 )

    set_control_par( get_ui_id( $rain_position_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $rain_stick_panel ) )
    hide_part( $rain_position_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $rain_position_label ), $CONTROL_PAR_POS_X, 156)
    set_control_par( get_ui_id( $rain_position_label ), $CONTROL_PAR_POS_Y, 50 )

    set_control_par( get_ui_id( $rain_stick_position_random ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $rain_stick_panel ) )
    set_control_par( get_ui_id( $rain_stick_position_random ), $CONTROL_PAR_POS_X, 235 )
    set_control_par( get_ui_id( $rain_stick_position_random ), $CONTROL_PAR_POS_Y, 15 )

    set_control_par( get_ui_id( $rain_stick_position_random_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $rain_stick_panel ) )
    hide_part( $rain_stick_position_random_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $rain_stick_position_random_label ), $CONTROL_PAR_POS_X, 226)
    set_control_par( get_ui_id( $rain_stick_position_random_label ), $CONTROL_PAR_POS_Y, 50 )

    set_control_par( get_ui_id( $rain_stick_volume ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $rain_stick_panel ) ) 
    set_control_par( get_ui_id( $rain_stick_volume ), $CONTROL_PAR_POS_X, 305 )
    set_control_par( get_ui_id( $rain_stick_volume ), $CONTROL_PAR_POS_Y, 15 )

    set_control_par( get_ui_id( $rain_stick_volume_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $rain_stick_panel ) )
    hide_part( $rain_stick_volume_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $rain_stick_volume_label ), $CONTROL_PAR_POS_X, 296)
    set_control_par( get_ui_id( $rain_stick_volume_label ), $CONTROL_PAR_POS_Y, 50 )

    {Native American Flute Group}
    declare ui_button $native_flute_toggle_button
    set_control_par( get_ui_id( $native_flute_toggle_button ), $CONTROL_PAR_WIDTH, 65 ) 
    set_control_par_str( get_ui_id( $native_flute_toggle_button ), $CONTROL_PAR_TEXT, "Native Flute" )

    declare ui_button $native_flute_reverse_button
    set_control_par( get_ui_id( $native_flute_reverse_button ), $CONTROL_PAR_WIDTH, 55 )
    set_control_par_str( get_ui_id( $native_flute_reverse_button ), $CONTROL_PAR_TEXT, "Reversed" )

    declare ui_slider $native_flute_position(0, 1000000 )         { slider for grain playback}
    declare ui_label $native_flute_position_label( 1, 1 )
        set_control_par_str( get_ui_id( $native_flute_position_label ), $CONTROL_PAR_TEXT, "POSITION" )

    declare ui_slider $native_flute_position_random(0, 1000000 )         {kalimba_position slider for grain playback}
    declare ui_label $native_flute_position_random_label( 1, 1 )
        set_control_par_str( get_ui_id( $native_flute_position_random_label ), $CONTROL_PAR_TEXT, "RANDOM" )
    
    declare ui_slider $native_flute_volume(0, 1000000)                  {Volume knob for Native Flute}
    declare ui_label $native_flute_volume_label( 1, 1 )
        set_control_par_str( get_ui_id( $native_flute_volume_label ), $CONTROL_PAR_TEXT, "VOLUME" )

    declare ui_panel $native_flute_panel
    set_control_par( get_ui_id( $native_flute_panel ), $CONTROL_PAR_POS_X, 20 )
    set_control_par( get_ui_id( $native_flute_panel ), $CONTROL_PAR_POS_Y, 120 + $height )

    set_control_par( get_ui_id( $native_flute_toggle_button ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $native_flute_panel ) )
    set_control_par( get_ui_id( $native_flute_toggle_button ), $CONTROL_PAR_POS_X, 0 )
    set_control_par( get_ui_id( $native_flute_toggle_button ), $CONTROL_PAR_POS_Y, 25 )

    set_control_par( get_ui_id( $native_flute_reverse_button ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $native_flute_panel ) )
    set_control_par( get_ui_id( $native_flute_reverse_button ), $CONTROL_PAR_POS_X, 70 )
    set_control_par( get_ui_id( $native_flute_reverse_button ), $CONTROL_PAR_POS_Y, 25 )

    set_control_par( get_ui_id( $native_flute_position ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $native_flute_panel ) )
    set_control_par( get_ui_id( $native_flute_position ), $CONTROL_PAR_POS_X, 165 )
    set_control_par( get_ui_id( $native_flute_position ), $CONTROL_PAR_POS_Y, 15 )

    set_control_par( get_ui_id( $native_flute_position_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $native_flute_panel ) )
    hide_part( $native_flute_position_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $native_flute_position_label ), $CONTROL_PAR_POS_X, 156)
    set_control_par( get_ui_id( $native_flute_position_label ), $CONTROL_PAR_POS_Y, 50 )

    set_control_par( get_ui_id( $native_flute_position_random ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $native_flute_panel ) )
    set_control_par( get_ui_id( $native_flute_position_random ), $CONTROL_PAR_POS_X, 235 )
    set_control_par( get_ui_id( $native_flute_position_random ), $CONTROL_PAR_POS_Y, 15 )

    set_control_par( get_ui_id( $native_flute_position_random_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $native_flute_panel ) )
    hide_part( $native_flute_position_random_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $native_flute_position_random_label ), $CONTROL_PAR_POS_X, 226)
    set_control_par( get_ui_id( $native_flute_position_random_label ), $CONTROL_PAR_POS_Y, 50 )

    set_control_par( get_ui_id( $native_flute_volume ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $native_flute_panel ) )
    set_control_par( get_ui_id( $native_flute_volume ), $CONTROL_PAR_POS_X, 305 )
    set_control_par( get_ui_id( $native_flute_volume ), $CONTROL_PAR_POS_Y, 15 )

    set_control_par( get_ui_id( $native_flute_volume_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $native_flute_panel ) )
    hide_part( $native_flute_volume_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $native_flute_volume_label ), $CONTROL_PAR_POS_X, 296)
    set_control_par( get_ui_id( $native_flute_volume_label ), $CONTROL_PAR_POS_Y, 50 )

    {Guitar Group}
    declare ui_button $guitar_toggle_button
    set_control_par( get_ui_id( $guitar_toggle_button ), $CONTROL_PAR_WIDTH, 40 )
    set_control_par_str( get_ui_id( $guitar_toggle_button ), $CONTROL_PAR_TEXT, "Guitar" )

    declare ui_button $guitar_reverse_button
    set_control_par( get_ui_id( $guitar_reverse_button ), $CONTROL_PAR_WIDTH, 55 )
    set_control_par_str( get_ui_id( $guitar_reverse_button ), $CONTROL_PAR_TEXT, "Reversed" )

    declare ui_slider $guitar_position(0, 1000000 )         { slider for grain playback}
    declare ui_label $guitar_position_label( 1, 1 )
        set_control_par_str( get_ui_id( $guitar_position_label ), $CONTROL_PAR_TEXT, "POSITION" )

    declare ui_slider $guitar_position_random(0, 1000000 )         {kalimba_position slider for grain playback}
    declare ui_label $guitar_position_random_label( 1, 1 )
        set_control_par_str( get_ui_id( $guitar_position_random_label ), $CONTROL_PAR_TEXT, "RANDOM" )

    declare ui_slider $guitar_volume(0, 1000000)                  {Volume knob for Guitar}
    declare ui_label $guitar_volume_label( 1, 1 )
        set_control_par_str( get_ui_id( $guitar_volume_label ), $CONTROL_PAR_TEXT, "VOLUME" )

    declare ui_panel $guitar_panel
    set_control_par( get_ui_id( $guitar_panel ), $CONTROL_PAR_POS_X, 20 )
    set_control_par( get_ui_id( $guitar_panel ), $CONTROL_PAR_POS_Y, 180 + $height)

    set_control_par( get_ui_id( $guitar_toggle_button ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $guitar_panel ) )
    set_control_par( get_ui_id( $guitar_toggle_button ), $CONTROL_PAR_POS_X, 20 )
    set_control_par( get_ui_id( $guitar_toggle_button ), $CONTROL_PAR_POS_Y, 25 )

    set_control_par( get_ui_id( $guitar_reverse_button ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $guitar_panel ) )
    set_control_par( get_ui_id( $guitar_reverse_button ), $CONTROL_PAR_POS_X, 70 )
    set_control_par( get_ui_id( $guitar_reverse_button ), $CONTROL_PAR_POS_Y, 25 )

    set_control_par( get_ui_id( $guitar_position ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $guitar_panel ) )
    set_control_par( get_ui_id( $guitar_position ), $CONTROL_PAR_POS_X, 165 )
    set_control_par( get_ui_id( $guitar_position ), $CONTROL_PAR_POS_Y, 15 )

    set_control_par( get_ui_id( $guitar_position_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $guitar_panel ) )
    hide_part( $guitar_position_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $guitar_position_label ), $CONTROL_PAR_POS_X, 156)
    set_control_par( get_ui_id( $guitar_position_label ), $CONTROL_PAR_POS_Y, 50 )

    set_control_par( get_ui_id( $guitar_position_random ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $guitar_panel ) )
    set_control_par( get_ui_id( $guitar_position_random ), $CONTROL_PAR_POS_X, 235 )
    set_control_par( get_ui_id( $guitar_position_random ), $CONTROL_PAR_POS_Y, 15 )

    set_control_par( get_ui_id( $guitar_position_random_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $guitar_panel ) )
    hide_part( $guitar_position_random_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $guitar_position_random_label ), $CONTROL_PAR_POS_X, 226)
    set_control_par( get_ui_id( $guitar_position_random_label ), $CONTROL_PAR_POS_Y, 50 )

    set_control_par( get_ui_id( $guitar_volume ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $guitar_panel ) )
    set_control_par( get_ui_id( $guitar_volume ), $CONTROL_PAR_POS_X, 305 )
    set_control_par( get_ui_id( $guitar_volume ), $CONTROL_PAR_POS_Y, 15 )

    set_control_par( get_ui_id( $guitar_volume_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $guitar_panel ) )
    hide_part( $guitar_volume_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $guitar_volume_label ), $CONTROL_PAR_POS_X, 296)
    set_control_par( get_ui_id( $guitar_volume_label ), $CONTROL_PAR_POS_Y, 50 )

    {Vocal Group}
    declare ui_button $vocal_toggle_button
    set_control_par( get_ui_id( $vocal_toggle_button ), $CONTROL_PAR_WIDTH, 40 )
    set_control_par_str( get_ui_id( $vocal_toggle_button ), $CONTROL_PAR_TEXT, "Vocal" )

    declare ui_button $vocal_reverse_button
    set_control_par( get_ui_id( $vocal_reverse_button ), $CONTROL_PAR_WIDTH, 55 )
    set_control_par_str( get_ui_id( $vocal_reverse_button ), $CONTROL_PAR_TEXT, "Reversed" )

    declare ui_slider $vocal_position(0, 1000000 )         { slider for grain playback}
    declare ui_label $vocal_position_label( 1, 1 )
        set_control_par_str( get_ui_id( $vocal_position_label ), $CONTROL_PAR_TEXT, "POSITION" )

    declare ui_slider $vocal_position_random(0, 1000000 )         {kalimba_position slider for grain playback}
    declare ui_label $vocal_position_random_label( 1, 1 )
        set_control_par_str( get_ui_id( $vocal_position_random_label ), $CONTROL_PAR_TEXT, "RANDOM" )
    
    declare ui_slider $vocal_volume(0, 1000000)                  {Volume knob for Vocal}
    declare ui_label $vocal_volume_label( 1, 1 )
        set_control_par_str( get_ui_id( $vocal_volume_label ), $CONTROL_PAR_TEXT, "VOLUME" )

    declare ui_panel $vocal_panel
    set_control_par( get_ui_id( $vocal_panel ), $CONTROL_PAR_POS_X, 20 )
    set_control_par( get_ui_id( $vocal_panel ), $CONTROL_PAR_POS_Y, 240 + $height )

    set_control_par( get_ui_id( $vocal_toggle_button ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $vocal_panel ) )
    set_control_par( get_ui_id( $vocal_toggle_button ), $CONTROL_PAR_POS_X, 20 )
    set_control_par( get_ui_id( $vocal_toggle_button ), $CONTROL_PAR_POS_Y, 25 )

    set_control_par( get_ui_id( $vocal_reverse_button ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $vocal_panel ) )
    set_control_par( get_ui_id( $vocal_reverse_button ), $CONTROL_PAR_POS_X, 70 )
    set_control_par( get_ui_id( $vocal_reverse_button ), $CONTROL_PAR_POS_Y, 25 )

    set_control_par( get_ui_id( $vocal_position ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $vocal_panel ) )
    set_control_par( get_ui_id( $vocal_position ), $CONTROL_PAR_POS_X, 165 )
    set_control_par( get_ui_id( $vocal_position ), $CONTROL_PAR_POS_Y, 15 )

    set_control_par( get_ui_id( $vocal_position_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $vocal_panel ) )
    hide_part( $vocal_position_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $vocal_position_label ), $CONTROL_PAR_POS_X, 146)
    set_control_par( get_ui_id( $vocal_position_label ), $CONTROL_PAR_POS_Y, 50 )

    set_control_par( get_ui_id( $vocal_position_random ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $vocal_panel ) )
    set_control_par( get_ui_id( $vocal_position_random ), $CONTROL_PAR_POS_X, 235 )
    set_control_par( get_ui_id( $vocal_position_random ), $CONTROL_PAR_POS_Y, 15 )

    set_control_par( get_ui_id( $vocal_position_random_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $vocal_panel ) )
    hide_part( $vocal_position_random_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $vocal_position_random_label ), $CONTROL_PAR_POS_X, 226)
    set_control_par( get_ui_id( $vocal_position_random_label ), $CONTROL_PAR_POS_Y, 50 )

    set_control_par( get_ui_id( $vocal_volume ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $vocal_panel ) )
    set_control_par( get_ui_id( $vocal_volume ), $CONTROL_PAR_POS_X, 305 )
    set_control_par( get_ui_id( $vocal_volume ), $CONTROL_PAR_POS_Y, 15 )

    set_control_par( get_ui_id( $vocal_volume_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $vocal_panel ) )
    hide_part( $vocal_volume_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $vocal_volume_label ), $CONTROL_PAR_POS_X, 296)
    set_control_par( get_ui_id( $vocal_volume_label ), $CONTROL_PAR_POS_Y, 50 )

    {Saw Pluck (MF_P1)}
    declare ui_button $sawpluck_toggle_button
    set_control_par( get_ui_id( $sawpluck_toggle_button ), $CONTROL_PAR_WIDTH, 60 )
    set_control_par_str( get_ui_id( $sawpluck_toggle_button ), $CONTROL_PAR_TEXT, "Saw Pluck" )

    declare ui_button $sawpluck_reverse_button
    set_control_par( get_ui_id( $sawpluck_reverse_button ), $CONTROL_PAR_WIDTH, 55 )
    set_control_par_str( get_ui_id( $sawpluck_reverse_button ), $CONTROL_PAR_TEXT, "Reversed" )

    declare ui_slider $sawpluck_position(0, 1000000 )         { slider for grain playback}    
    declare ui_label $sawpluck_position_label( 1, 1 )
    set_control_par_str( get_ui_id( $sawpluck_position_label ), $CONTROL_PAR_TEXT, "POSITION" )

    declare ui_slider $sawpluck_position_random(0, 1000000 )         {kalimba_position slider for grain playback}
    declare ui_label $sawpluck_position_random_label( 1, 1 )
    set_control_par_str( get_ui_id( $sawpluck_position_random_label ), $CONTROL_PAR_TEXT, "RANDOM" )

    declare ui_slider $sawpluck_volume(0, 1000000)                  {Volume knob for Saw Pluck}
    declare ui_label $sawpluck_volume_label( 1, 1 )
    set_control_par_str( get_ui_id( $sawpluck_volume_label ), $CONTROL_PAR_TEXT, "VOLUME" )

    declare ui_panel $sawpluck_panel
    set_control_par( get_ui_id( $sawpluck_panel ), $CONTROL_PAR_POS_X, 630 )
    set_control_par( get_ui_id( $sawpluck_panel ), $CONTROL_PAR_POS_Y, 10 )

    set_control_par( get_ui_id( $sawpluck_toggle_button ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $sawpluck_panel ) )
    set_control_par( get_ui_id( $sawpluck_toggle_button ), $CONTROL_PAR_POS_X, 0 )
    set_control_par( get_ui_id( $sawpluck_toggle_button ), $CONTROL_PAR_POS_Y, 25 )

    set_control_par( get_ui_id( $sawpluck_reverse_button ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $sawpluck_panel ) )
    set_control_par( get_ui_id( $sawpluck_reverse_button ), $CONTROL_PAR_POS_X, 70 )
    set_control_par( get_ui_id( $sawpluck_reverse_button ), $CONTROL_PAR_POS_Y, 25 )

    set_control_par( get_ui_id( $sawpluck_position ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $sawpluck_panel ) )
    set_control_par( get_ui_id( $sawpluck_position ), $CONTROL_PAR_POS_X, 165 )
    set_control_par( get_ui_id( $sawpluck_position ), $CONTROL_PAR_POS_Y, 15 )

    set_control_par( get_ui_id( $sawpluck_position_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $sawpluck_panel ) )
    hide_part( $sawpluck_position_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $sawpluck_position_label ), $CONTROL_PAR_POS_X, 156)
    set_control_par( get_ui_id( $sawpluck_position_label ), $CONTROL_PAR_POS_Y, 50 )

    set_control_par( get_ui_id( $sawpluck_position_random ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $sawpluck_panel ) )
    set_control_par( get_ui_id( $sawpluck_position_random ), $CONTROL_PAR_POS_X, 235 )
    set_control_par( get_ui_id( $sawpluck_position_random ), $CONTROL_PAR_POS_Y, 15 )

    set_control_par( get_ui_id( $sawpluck_position_random_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $sawpluck_panel ) )
    hide_part( $sawpluck_position_random_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $sawpluck_position_random_label ), $CONTROL_PAR_POS_X, 226)
    set_control_par( get_ui_id( $sawpluck_position_random_label ), $CONTROL_PAR_POS_Y, 50 )

    set_control_par( get_ui_id( $sawpluck_volume ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $sawpluck_panel ) )
    set_control_par( get_ui_id( $sawpluck_volume ), $CONTROL_PAR_POS_X, 305 )
    set_control_par( get_ui_id( $sawpluck_volume ), $CONTROL_PAR_POS_Y, 15 )

    set_control_par( get_ui_id( $sawpluck_volume_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $sawpluck_panel ) )
    hide_part( $sawpluck_volume_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $sawpluck_volume_label ), $CONTROL_PAR_POS_X, 296)
    set_control_par( get_ui_id( $sawpluck_volume_label ), $CONTROL_PAR_POS_Y, 50 )

    {Piano Group}
    declare ui_button $piano_toggle_button
    set_control_par( get_ui_id( $piano_toggle_button ), $CONTROL_PAR_WIDTH, 40 )
    set_control_par_str( get_ui_id( $piano_toggle_button ), $CONTROL_PAR_TEXT, "Piano" )

    declare ui_button $piano_reverse_button
    set_control_par( get_ui_id( $piano_reverse_button ), $CONTROL_PAR_WIDTH, 55 )
    set_control_par_str( get_ui_id( $piano_reverse_button ), $CONTROL_PAR_TEXT, "Reversed" )

    declare ui_slider $piano_position(0, 1000000 )         { slider for grain playback}
    declare ui_label $piano_position_label( 1, 1 )
        set_control_par_str( get_ui_id( $piano_position_label ), $CONTROL_PAR_TEXT, "POSITION" )

    declare ui_slider $piano_position_random(0, 1000000 )         {kalimba_position slider for grain playback}
    declare ui_label $piano_position_random_label( 1, 1 )
        set_control_par_str( get_ui_id( $piano_position_random_label ), $CONTROL_PAR_TEXT, "RANDOM" )

    declare ui_slider $piano_volume(0, 1000000)                  {Volume knob for Piano}
    declare ui_label $piano_volume_label( 1, 1 )
        set_control_par_str( get_ui_id( $piano_volume_label ), $CONTROL_PAR_TEXT, "VOLUME" )

    declare ui_panel $piano_panel
    set_control_par( get_ui_id( $piano_panel ), $CONTROL_PAR_POS_X, 20 )
    set_control_par( get_ui_id( $piano_panel ), $CONTROL_PAR_POS_Y, 60 + $height)

    set_control_par( get_ui_id( $piano_toggle_button ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $piano_panel ) )
    set_control_par( get_ui_id( $piano_toggle_button ), $CONTROL_PAR_POS_X, 20 )
    set_control_par( get_ui_id( $piano_toggle_button ), $CONTROL_PAR_POS_Y, 25 )

    set_control_par( get_ui_id( $piano_reverse_button ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $piano_panel ) )
    set_control_par( get_ui_id( $piano_reverse_button ), $CONTROL_PAR_POS_X, 70 )
    set_control_par( get_ui_id( $piano_reverse_button ), $CONTROL_PAR_POS_Y, 25 )

    set_control_par( get_ui_id( $piano_position ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $piano_panel ) )
    set_control_par( get_ui_id( $piano_position ), $CONTROL_PAR_POS_X, 165 )
    set_control_par( get_ui_id( $piano_position ), $CONTROL_PAR_POS_Y, 15 )

    set_control_par( get_ui_id( $piano_position_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $piano_panel ) )
    hide_part( $piano_position_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $piano_position_label ), $CONTROL_PAR_POS_X, 156)
    set_control_par( get_ui_id( $piano_position_label ), $CONTROL_PAR_POS_Y, 50 )

    set_control_par( get_ui_id( $piano_position_random ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $piano_panel ) )
    set_control_par( get_ui_id( $piano_position_random ), $CONTROL_PAR_POS_X, 235 )
    set_control_par( get_ui_id( $piano_position_random ), $CONTROL_PAR_POS_Y, 15 )

    set_control_par( get_ui_id( $piano_position_random_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $piano_panel ) )
    hide_part( $piano_position_random_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $piano_position_random_label ), $CONTROL_PAR_POS_X, 226)
    set_control_par( get_ui_id( $piano_position_random_label ), $CONTROL_PAR_POS_Y, 50 )

    set_control_par( get_ui_id( $piano_volume ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $piano_panel ) )
    set_control_par( get_ui_id( $piano_volume ), $CONTROL_PAR_POS_X, 305 )
    set_control_par( get_ui_id( $piano_volume ), $CONTROL_PAR_POS_Y, 15 )

    set_control_par( get_ui_id( $piano_volume_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $piano_panel ) )
    hide_part( $piano_volume_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $piano_volume_label ), $CONTROL_PAR_POS_X, 296)
    set_control_par( get_ui_id( $piano_volume_label ), $CONTROL_PAR_POS_Y, 50 )

    {Ethereal Lead Group}
    declare ui_button $ethereal_toggle_button
    set_control_par( get_ui_id( $ethereal_toggle_button ), $CONTROL_PAR_WIDTH, 75 )
    set_control_par_str( get_ui_id( $ethereal_toggle_button ), $CONTROL_PAR_TEXT, "Ethereal Lead" )

    declare ui_button $ethereal_reverse_button
    set_control_par( get_ui_id( $ethereal_reverse_button ), $CONTROL_PAR_WIDTH, 55 )
    set_control_par_str( get_ui_id( $ethereal_reverse_button ), $CONTROL_PAR_TEXT, "Reversed" )

    declare ui_slider $ethereal_position(0, 1000000 )         { slider for grain playback}
    declare ui_label $ethereal_position_label( 1, 1 )
        set_control_par_str( get_ui_id( $ethereal_position_label ), $CONTROL_PAR_TEXT, "POSITION" )

    declare ui_slider $ethereal_position_random(0, 1000000 )         {kalimba_position slider for grain playback}
    declare ui_label $ethereal_position_random_label( 1, 1 )
        set_control_par_str( get_ui_id( $ethereal_position_random_label ), $CONTROL_PAR_TEXT, "RANDOM" )
    
    declare ui_slider $ethereal_volume(0, 1000000)                  {Volume knob for Ethereal Lead}
    declare ui_label $ethereal_volume_label( 1, 1 )
        set_control_par_str( get_ui_id( $ethereal_volume_label ), $CONTROL_PAR_TEXT, "VOLUME" )

    declare ui_panel $ethereal_panel
    set_control_par( get_ui_id( $ethereal_panel ), $CONTROL_PAR_POS_X, 620 )
    set_control_par( get_ui_id( $ethereal_panel ), $CONTROL_PAR_POS_Y, 70 )

    set_control_par( get_ui_id( $ethereal_toggle_button ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $ethereal_panel ) )
    set_control_par( get_ui_id( $ethereal_toggle_button ), $CONTROL_PAR_POS_X, 0 )
    set_control_par( get_ui_id( $ethereal_toggle_button ), $CONTROL_PAR_POS_Y, 25 )

    set_control_par( get_ui_id( $ethereal_reverse_button ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $ethereal_panel ) )
    set_control_par( get_ui_id( $ethereal_reverse_button ), $CONTROL_PAR_POS_X, 70 + $height)
    set_control_par( get_ui_id( $ethereal_reverse_button ), $CONTROL_PAR_POS_Y, 25 )

    set_control_par( get_ui_id( $ethereal_position ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $ethereal_panel ) )
    set_control_par( get_ui_id( $ethereal_position ), $CONTROL_PAR_POS_X, 165 + $height)
    set_control_par( get_ui_id( $ethereal_position ), $CONTROL_PAR_POS_Y, 15 )

    set_control_par( get_ui_id( $ethereal_position_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $ethereal_panel ) )
    hide_part( $ethereal_position_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $ethereal_position_label ), $CONTROL_PAR_POS_X, 156 + $height)
    set_control_par( get_ui_id( $ethereal_position_label ), $CONTROL_PAR_POS_Y, 50 )

    set_control_par( get_ui_id( $ethereal_position_random ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $ethereal_panel ) )
    set_control_par( get_ui_id( $ethereal_position_random ), $CONTROL_PAR_POS_X, 235 + $height)
    set_control_par( get_ui_id( $ethereal_position_random ), $CONTROL_PAR_POS_Y, 15 )

    set_control_par( get_ui_id( $ethereal_position_random_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $ethereal_panel ) )
    hide_part( $ethereal_position_random_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $ethereal_position_random_label ), $CONTROL_PAR_POS_X, 226 + $height)
    set_control_par( get_ui_id( $ethereal_position_random_label ), $CONTROL_PAR_POS_Y, 50 )

    set_control_par( get_ui_id( $ethereal_volume ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $ethereal_panel ) )
    set_control_par( get_ui_id( $ethereal_volume ), $CONTROL_PAR_POS_X, 305 + $height)
    set_control_par( get_ui_id( $ethereal_volume ), $CONTROL_PAR_POS_Y, 15 )

    set_control_par( get_ui_id( $ethereal_volume_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $ethereal_panel ) )
    hide_part( $ethereal_volume_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $ethereal_volume_label ), $CONTROL_PAR_POS_X, 296 + $height)
    set_control_par( get_ui_id( $ethereal_volume_label ), $CONTROL_PAR_POS_Y, 50 )

    {Sine Pluck}
    declare ui_button $sinepluck_toggle_button
    set_control_par( get_ui_id( $sinepluck_toggle_button ), $CONTROL_PAR_WIDTH, 60 )
    set_control_par_str( get_ui_id( $sinepluck_toggle_button ), $CONTROL_PAR_TEXT, "Sine Pluck" )

    declare ui_button $sinepluck_reverse_button
    set_control_par( get_ui_id( $sinepluck_reverse_button ), $CONTROL_PAR_WIDTH, 55 )
    set_control_par_str( get_ui_id( $sinepluck_reverse_button ), $CONTROL_PAR_TEXT, "Reversed" )

    declare ui_slider $sinepluck_position(0, 1000000 )         { slider for grain playback}
    declare ui_label $sinepluck_position_label( 1, 1 )
        set_control_par_str( get_ui_id( $sinepluck_position_label ), $CONTROL_PAR_TEXT, "POSITION" )

    declare ui_slider $sinepluck_position_random(0, 1000000 )         {kalimba_position slider for grain playback}
    declare ui_label $sinepluck_position_random_label( 1, 1 )
        set_control_par_str( get_ui_id( $sinepluck_position_random_label ), $CONTROL_PAR_TEXT, "RANDOM" )

    declare ui_slider $sinepluck_volume(0, 1000000)                  {Volume knob for Sine Pluck}
    declare ui_label $sinepluck_volume_label( 1, 1 )
        set_control_par_str( get_ui_id( $sinepluck_volume_label ), $CONTROL_PAR_TEXT, "VOLUME" )

    declare ui_panel $sinepluck_panel
    set_control_par( get_ui_id( $sinepluck_panel ), $CONTROL_PAR_POS_X, 630 )
    set_control_par( get_ui_id( $sinepluck_panel ), $CONTROL_PAR_POS_Y, 130 )

    set_control_par( get_ui_id( $sinepluck_toggle_button ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $sinepluck_panel ) )
    set_control_par( get_ui_id( $sinepluck_toggle_button ), $CONTROL_PAR_POS_X, 0 )
    set_control_par( get_ui_id( $sinepluck_toggle_button ), $CONTROL_PAR_POS_Y, 25 )

    set_control_par( get_ui_id( $sinepluck_reverse_button ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $sinepluck_panel ) )
    set_control_par( get_ui_id( $sinepluck_reverse_button ), $CONTROL_PAR_POS_X, 70 )
    set_control_par( get_ui_id( $sinepluck_reverse_button ), $CONTROL_PAR_POS_Y, 25 )

    set_control_par( get_ui_id( $sinepluck_position ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $sinepluck_panel ) )
    set_control_par( get_ui_id( $sinepluck_position ), $CONTROL_PAR_POS_X, 165 )
    set_control_par( get_ui_id( $sinepluck_position ), $CONTROL_PAR_POS_Y, 15 )

    set_control_par( get_ui_id( $sinepluck_position_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $sinepluck_panel ) )
    hide_part( $sinepluck_position_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $sinepluck_position_label ), $CONTROL_PAR_POS_X, 156)
    set_control_par( get_ui_id( $sinepluck_position_label ), $CONTROL_PAR_POS_Y, 50 )

    set_control_par( get_ui_id( $sinepluck_position_random ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $sinepluck_panel ) )
    set_control_par( get_ui_id( $sinepluck_position_random ), $CONTROL_PAR_POS_X, 235 )
    set_control_par( get_ui_id( $sinepluck_position_random ), $CONTROL_PAR_POS_Y, 15 )

    set_control_par( get_ui_id( $sinepluck_position_random_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $sinepluck_panel ) )
    hide_part( $sinepluck_position_random_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $sinepluck_position_random_label ), $CONTROL_PAR_POS_X, 226)
    set_control_par( get_ui_id( $sinepluck_position_random_label ), $CONTROL_PAR_POS_Y, 50 )

    set_control_par( get_ui_id( $sinepluck_volume ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $sinepluck_panel ) )
    set_control_par( get_ui_id( $sinepluck_volume ), $CONTROL_PAR_POS_X, 305 )
    set_control_par( get_ui_id( $sinepluck_volume ), $CONTROL_PAR_POS_Y, 15 )

    set_control_par( get_ui_id( $sinepluck_volume_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $sinepluck_panel ) )
    hide_part( $sinepluck_volume_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $sinepluck_volume_label ), $CONTROL_PAR_POS_X, 296)
    set_control_par( get_ui_id( $sinepluck_volume_label ), $CONTROL_PAR_POS_Y, 50 )

    {Water Drop Group}
    declare ui_button $waterdrop_toggle_button
    set_control_par( get_ui_id( $waterdrop_toggle_button ), $CONTROL_PAR_WIDTH, 62 )
    set_control_par_str( get_ui_id( $waterdrop_toggle_button ), $CONTROL_PAR_TEXT, "Water Drop" )

    declare ui_button $waterdrop_reverse_button
    set_control_par( get_ui_id( $waterdrop_reverse_button ), $CONTROL_PAR_WIDTH, 55 )
    set_control_par_str( get_ui_id( $waterdrop_reverse_button ), $CONTROL_PAR_TEXT, "Reversed" )

    declare ui_slider $waterdrop_position(0, 1000000 )         { slider for grain playback}
    declare ui_label $waterdrop_position_label( 1, 1 )
        set_control_par_str( get_ui_id( $waterdrop_position_label ), $CONTROL_PAR_TEXT, "POSITION" )

    declare ui_slider $waterdrop_position_random(0, 1000000 )         {kalimba_position slider for grain playback}
    declare ui_label $waterdrop_position_random_label( 1, 1 )
        set_control_par_str( get_ui_id( $waterdrop_position_random_label ), $CONTROL_PAR_TEXT, "RANDOM" )

    declare ui_slider $waterdrop_volume(0, 1000000)                  {Volume knob for Water Drop}
    declare ui_label $waterdrop_volume_label( 1, 1 )
        set_control_par_str( get_ui_id( $waterdrop_volume_label ), $CONTROL_PAR_TEXT, "VOLUME" )

    declare ui_panel $waterdrop_panel
    set_control_par( get_ui_id( $waterdrop_panel ), $CONTROL_PAR_POS_X, 630 )
    set_control_par( get_ui_id( $waterdrop_panel ), $CONTROL_PAR_POS_Y, 250 )

    set_control_par( get_ui_id( $waterdrop_toggle_button ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $waterdrop_panel ) )
    set_control_par( get_ui_id( $waterdrop_toggle_button ), $CONTROL_PAR_POS_X, 0 )
    set_control_par( get_ui_id( $waterdrop_toggle_button ), $CONTROL_PAR_POS_Y, 25 )

    set_control_par( get_ui_id( $waterdrop_reverse_button ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $waterdrop_panel ) )
    set_control_par( get_ui_id( $waterdrop_reverse_button ), $CONTROL_PAR_POS_X, 70 )
    set_control_par( get_ui_id( $waterdrop_reverse_button ), $CONTROL_PAR_POS_Y, 25 )

    set_control_par( get_ui_id( $waterdrop_position ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $waterdrop_panel ) )
    set_control_par( get_ui_id( $waterdrop_position ), $CONTROL_PAR_POS_X, 165 )
    set_control_par( get_ui_id( $waterdrop_position ), $CONTROL_PAR_POS_Y, 15 )

    set_control_par( get_ui_id( $waterdrop_position_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $waterdrop_panel ) )
    hide_part( $waterdrop_position_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $waterdrop_position_label ), $CONTROL_PAR_POS_X, 156)
    set_control_par( get_ui_id( $waterdrop_position_label ), $CONTROL_PAR_POS_Y, 50 )

    set_control_par( get_ui_id( $waterdrop_position_random ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $waterdrop_panel ) )
    set_control_par( get_ui_id( $waterdrop_position_random ), $CONTROL_PAR_POS_X, 235 )
    set_control_par( get_ui_id( $waterdrop_position_random ), $CONTROL_PAR_POS_Y, 15 )

    set_control_par( get_ui_id( $waterdrop_position_random_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $waterdrop_panel ) )
    hide_part( $waterdrop_position_random_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $waterdrop_position_random_label ), $CONTROL_PAR_POS_X, 226)
    set_control_par( get_ui_id( $waterdrop_position_random_label ), $CONTROL_PAR_POS_Y, 50 )

    set_control_par( get_ui_id( $waterdrop_volume ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $waterdrop_panel ) )
    set_control_par( get_ui_id( $waterdrop_volume ), $CONTROL_PAR_POS_X, 305 )
    set_control_par( get_ui_id( $waterdrop_volume ), $CONTROL_PAR_POS_Y, 15 )

    set_control_par( get_ui_id( $waterdrop_volume_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $waterdrop_panel ) )
    hide_part( $waterdrop_volume_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $waterdrop_volume_label ), $CONTROL_PAR_POS_X, 296)
    set_control_par( get_ui_id( $waterdrop_volume_label ), $CONTROL_PAR_POS_Y, 50 )


    {Granular Engine Parameters}
    declare ui_slider $grainAmount(1,100)               {Grains per second}
    declare $timebetweenGrains                          {time between grains in microseconds}
    declare $offset := 0                                {Offset for grain playback (Can be used for randomization later)}
    declare $grainID := 0                               {ID for the grain being played}
    declare ui_slider $grainDuration(45442, 696711)     {HOLD values for 1ms to 1000ms}
    declare $note_playing := 0                          {Flag to check if a note is playing}

    declare ui_slider $width_knob (0, 1000)              {width_knob for the grains}
    declare ui_label $width_label(1,1)
        set_control_par_str( get_ui_id( $width_label ), $CONTROL_PAR_TEXT, "WIDTH" )
    declare $new_id

    declare $count := 0

    declare ui_label $grainAmount_label(1,1)
        set_control_par_str( get_ui_id( $grainAmount_label ), $CONTROL_PAR_TEXT, "" ) 
    declare ui_label $grainDuration_label(1,1)
        set_control_par_str( get_ui_id( $grainDuration_label ), $CONTROL_PAR_TEXT, "" )




    {Poliphony Settings}
    declare %note_active[128]
    declare %evento_id[128]




    {LFO setting}
    declare ui_slider $lfo_freq(0, 692000) {LFO rate}
    declare ui_label $lfo_freq_label(1,1)
        set_control_par_str( get_ui_id( $lfo_freq_label ), $CONTROL_PAR_TEXT, " FREQ" )

    declare ui_slider $lfo_depth(0, 1000000) {LFO depth}
    declare ui_label $lfo_depth_label(1,1)
        set_control_par_str( get_ui_id( $lfo_depth_label ), $CONTROL_PAR_TEXT, "DEPTH" )

    declare ui_slider $lfo_fade_in(0, 1000000) {LFO fade in}
    declare ui_label $lfo_fade_in_label(1,1)
        set_control_par_str( get_ui_id( $lfo_fade_in_label ), $CONTROL_PAR_TEXT, "FADE IN" )

    {LFO Settings Panel}
    declare ui_panel $LFOSettingsPanel
    set_control_par( get_ui_id( $LFOSettingsPanel ), $CONTROL_PAR_POS_X, 296 )
    set_control_par( get_ui_id( $LFOSettingsPanel ), $CONTROL_PAR_POS_Y, 255 )

    set_control_par( get_ui_id( $lfo_freq ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $LFOSettingsPanel ) )
    set_control_par( get_ui_id( $lfo_freq ), $CONTROL_PAR_POS_X, 100 )
    set_control_par( get_ui_id( $lfo_freq ), $CONTROL_PAR_POS_Y, 20 )

    set_control_par( get_ui_id( $lfo_freq_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $LFOSettingsPanel ) )
    hide_part( $lfo_freq_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $lfo_freq_label ), $CONTROL_PAR_POS_X, 98 )
    set_control_par( get_ui_id( $lfo_freq_label ), $CONTROL_PAR_POS_Y, 60 )
    
    set_control_par( get_ui_id( $lfo_depth ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $LFOSettingsPanel ) )
    set_control_par( get_ui_id( $lfo_depth ), $CONTROL_PAR_POS_X, 160 )
    set_control_par( get_ui_id( $lfo_depth ), $CONTROL_PAR_POS_Y, 0 )

    set_control_par( get_ui_id( $lfo_depth_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $LFOSettingsPanel ) )
    hide_part( $lfo_depth_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $lfo_depth_label ), $CONTROL_PAR_POS_X, 173 )
    set_control_par( get_ui_id( $lfo_depth_label ), $CONTROL_PAR_POS_Y, 60 )

    set_control_par( get_ui_id( $lfo_fade_in ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $LFOSettingsPanel ) )
    set_control_par( get_ui_id( $lfo_fade_in ), $CONTROL_PAR_POS_X, 254 )
    set_control_par( get_ui_id( $lfo_fade_in ), $CONTROL_PAR_POS_Y, 20 )

    set_control_par( get_ui_id( $lfo_fade_in_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $LFOSettingsPanel ) )
    hide_part( $lfo_fade_in_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $lfo_fade_in_label ), $CONTROL_PAR_POS_X, 249 )
    set_control_par( get_ui_id( $lfo_fade_in_label ), $CONTROL_PAR_POS_Y, 60 )


    {Effect Settings}
    declare ui_button $effects_bypass_all
    declare %bypassed[4]
    set_control_par( get_ui_id( $effects_bypass_all ), $CONTROL_PAR_WIDTH, 69 )
    set_control_par_str( get_ui_id( $effects_bypass_all ), $CONTROL_PAR_TEXT, "BYPASS ALL" )
    set_control_par( get_ui_id( $effects_bypass_all ), $CONTROL_PAR_POS_X, 926)
    set_control_par( get_ui_id( $effects_bypass_all ), $CONTROL_PAR_POS_Y, 330 )

        {Reverb}
    declare ui_slider $reverb_amount(0, 1000000) {Reverb amount}
    declare ui_label $reverb_amount_label(1,1)
        set_control_par_str( get_ui_id( $reverb_amount_label ), $CONTROL_PAR_TEXT, "AMOUNT" )
    
    declare ui_slider $reverb_pre_delay(0, 1000000) {Reverb pre-delay}
    declare ui_label $reverb_pre_delay_label(1,1)
        set_control_par_str( get_ui_id( $reverb_pre_delay_label ), $CONTROL_PAR_TEXT, "PRE-DELAY" )

    declare ui_slider $reverb_time(0, 1000000) {Reverb decay time}
    declare ui_label $reverb_time_label(1,1)
        set_control_par_str( get_ui_id( $reverb_time_label ), $CONTROL_PAR_TEXT, "TIME" )
    
    declare ui_slider $reverb_size(0, 1000000) {Reverb size}
    declare ui_label $reverb_size_label(1,1)
        set_control_par_str( get_ui_id( $reverb_size_label ), $CONTROL_PAR_TEXT, "SIZE" )
    
    declare ui_slider $reverb_stereo(0, 1000000) {Reverb stereo width}
    declare ui_label $reverb_stereo_label(1,1)
        set_control_par_str( get_ui_id( $reverb_stereo_label ), $CONTROL_PAR_TEXT, "STEREO" )

    declare ui_slider $reverb_low_shelf(0, 1000000) {Reverb low shelf}
    declare ui_label $reverb_low_shelf_label(1,1)
        set_control_par_str( get_ui_id( $reverb_low_shelf_label ), $CONTROL_PAR_TEXT, "LOW SHELF" )
    
    declare ui_slider $reverb_high_cut(0, 1000000) {Reverb high cut}
    declare ui_label $reverb_high_cut_label(1,1)
        set_control_par_str( get_ui_id( $reverb_high_cut_label ), $CONTROL_PAR_TEXT, "HIGH CUT" )

    declare ui_button $reverb_bypass_button
    set_control_par( get_ui_id( $reverb_bypass_button ), $CONTROL_PAR_WIDTH, 50 )
    set_control_par_str( get_ui_id( $reverb_bypass_button ), $CONTROL_PAR_TEXT, "BYPASS" )

        {Filter}
    declare ui_slider $filter_lowcut(0, 1000000) {Filter low cut}
    declare ui_label $filter_lowcut_label(1,1)
        set_control_par_str( get_ui_id( $filter_lowcut_label ), $CONTROL_PAR_TEXT, "LOW CUT" )

    declare ui_slider $filter_lowcut_resonance(0, 1000000) {Filter low cut resonance}
    declare ui_label $filter_lowcut_resonance_label(1,1)
        set_control_par_str( get_ui_id( $filter_lowcut_resonance_label ), $CONTROL_PAR_TEXT, "LC RES" )

    declare ui_slider $filter_highcut(0, 1000000) {Filter high cut}
    declare ui_label $filter_highcut_label(1,1)
        set_control_par_str( get_ui_id( $filter_highcut_label ), $CONTROL_PAR_TEXT, "HIGH CUT" )    

    declare ui_slider $filter_highcut_resonance(0, 1000000) {Filter low cut resonance}
    declare ui_label $filter_highcut_resonance_label(1,1)
        set_control_par_str( get_ui_id( $filter_highcut_resonance_label ), $CONTROL_PAR_TEXT, "HC RES" )

    declare ui_button $filter_bypass_button
    set_control_par( get_ui_id( $filter_bypass_button ), $CONTROL_PAR_WIDTH, 50 )
    set_control_par_str( get_ui_id( $filter_bypass_button ), $CONTROL_PAR_TEXT, "BYPASS" )

        {Psyche Delay slot 0}
    declare ui_button $psyche_delay_toggle_button
    set_control_par( get_ui_id( $psyche_delay_toggle_button ), $CONTROL_PAR_VALUE, 1)
    set_control_par( get_ui_id( $psyche_delay_toggle_button ), $CONTROL_PAR_WIDTH, 70 )
    set_control_par_str( get_ui_id( $psyche_delay_toggle_button ), $CONTROL_PAR_TEXT, "Psyche Delay" )

    set_control_par( get_ui_id( $psyche_delay_toggle_button ), $CONTROL_PAR_POS_X, 240 )
    set_control_par( get_ui_id( $psyche_delay_toggle_button ), $CONTROL_PAR_POS_Y, 330 )

    declare ui_slider $psyche_delay_amount(0, 1000000) {Psyche delay amount}
    declare ui_label $psyche_delay_amount_label(1,1)
        set_control_par_str( get_ui_id( $psyche_delay_amount_label ), $CONTROL_PAR_TEXT, "AMOUNT" )

    declare ui_slider $psyche_delay_time(0, 1000000) {Psyche delay time}
    declare ui_label $psyche_delay_time_label(1,1)
        set_control_par_str( get_ui_id( $psyche_delay_time_label ), $CONTROL_PAR_TEXT, "TIME" )

    declare ui_slider $psyche_delay_feedback(0, 1000000) {Psyche delay feedback}
    declare ui_label $psyche_delay_feedback_label(1,1)
        set_control_par_str( get_ui_id( $psyche_delay_feedback_label ), $CONTROL_PAR_TEXT, "FEEDBACK" )

    declare ui_slider $psyche_delay_lr_offset(0, 1000000) {Psyche delay left/right offset}
    declare ui_label $psyche_delay_lr_offset_label(1,1)
        set_control_par_str( get_ui_id( $psyche_delay_lr_offset_label ), $CONTROL_PAR_TEXT, "LR OFFSET" )

    declare ui_slider $psyche_delay_cross_fb(0, 1000000) {Psyche delay cross feedback}
    declare ui_label $psyche_delay_cross_fb_label(1,1)
        set_control_par_str( get_ui_id( $psyche_delay_cross_fb_label ), $CONTROL_PAR_TEXT, "CROSS FB" )

    declare ui_slider $psyche_delay_pitch(0, 1000000) {Psyche delay pitch}
    declare ui_label $psyche_delay_pitch_label(1,1)
        set_control_par_str( get_ui_id( $psyche_delay_pitch_label ), $CONTROL_PAR_TEXT, "PITCH" )
    
    declare ui_slider $psyche_delay_detune(0, 1000000) {Psyche delay detune}
    declare ui_label $psyche_delay_detune_label(1,1)
        set_control_par_str( get_ui_id( $psyche_delay_detune_label ), $CONTROL_PAR_TEXT, "DETUNE" )
    
    declare ui_button $psyche_delay_reversed_button
    set_control_par( get_ui_id( $psyche_delay_reversed_button ), $CONTROL_PAR_WIDTH, 60 )
    set_control_par_str( get_ui_id( $psyche_delay_reversed_button ), $CONTROL_PAR_TEXT, "REVERSED" )
    set_engine_par( $ENGINE_PAR_PSYDL_REVERSE, $psyche_delay_reversed_button, -1, 0, $NI_SEND_BUS )

    declare ui_button $psyche_delay_bypass_button
    set_control_par( get_ui_id( $psyche_delay_bypass_button ), $CONTROL_PAR_WIDTH, 50 )
    set_control_par_str( get_ui_id( $psyche_delay_bypass_button ), $CONTROL_PAR_TEXT, "BYPASS" )
    
    
    {Psyche Delay Settings Panel}
    declare ui_panel $PsycheDelaySettingsPanel
    set_control_par( get_ui_id( $PsycheDelaySettingsPanel ), $CONTROL_PAR_POS_X, 244 )
    set_control_par( get_ui_id( $PsycheDelaySettingsPanel ), $CONTROL_PAR_POS_Y, 300 )

    set_control_par( get_ui_id( $psyche_delay_amount ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $PsycheDelaySettingsPanel ) )
    set_control_par( get_ui_id( $psyche_delay_amount ), $CONTROL_PAR_POS_X, 120 )
    set_control_par( get_ui_id( $psyche_delay_amount ), $CONTROL_PAR_POS_Y, 75 )

    set_control_par( get_ui_id( $psyche_delay_amount_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $PsycheDelaySettingsPanel ) )
    hide_part( $psyche_delay_amount_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $psyche_delay_amount_label ), $CONTROL_PAR_POS_X, 132 )
    set_control_par( get_ui_id( $psyche_delay_amount_label ), $CONTROL_PAR_POS_Y, 140 )

    set_control_par( get_ui_id( $psyche_delay_time ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $PsycheDelaySettingsPanel ) )
    set_control_par( get_ui_id( $psyche_delay_time ), $CONTROL_PAR_POS_X, 200 )
    set_control_par( get_ui_id( $psyche_delay_time ), $CONTROL_PAR_POS_Y, 115 )

    set_control_par( get_ui_id( $psyche_delay_time_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $PsycheDelaySettingsPanel ) )
    hide_part( $psyche_delay_time_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $psyche_delay_time_label ), $CONTROL_PAR_POS_X, 200 )
    set_control_par( get_ui_id( $psyche_delay_time_label ), $CONTROL_PAR_POS_Y, 150 )

    set_control_par( get_ui_id( $psyche_delay_feedback ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $PsycheDelaySettingsPanel ) )
    set_control_par( get_ui_id( $psyche_delay_feedback ), $CONTROL_PAR_POS_X, 200 )
    set_control_par( get_ui_id( $psyche_delay_feedback ), $CONTROL_PAR_POS_Y, 60 )

    set_control_par( get_ui_id( $psyche_delay_feedback_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $PsycheDelaySettingsPanel ) )
    hide_part( $psyche_delay_feedback_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $psyche_delay_feedback_label ), $CONTROL_PAR_POS_X, 188 )
    set_control_par( get_ui_id( $psyche_delay_feedback_label ), $CONTROL_PAR_POS_Y, 95 )

    set_control_par( get_ui_id( $psyche_delay_lr_offset ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $PsycheDelaySettingsPanel ) )
    set_control_par( get_ui_id( $psyche_delay_lr_offset ), $CONTROL_PAR_POS_X, 72 )
    set_control_par( get_ui_id( $psyche_delay_lr_offset ), $CONTROL_PAR_POS_Y, 60 )

    set_control_par( get_ui_id( $psyche_delay_lr_offset_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $PsycheDelaySettingsPanel ) )
    hide_part( $psyche_delay_lr_offset_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $psyche_delay_lr_offset_label ), $CONTROL_PAR_POS_X, 59 )
    set_control_par( get_ui_id( $psyche_delay_lr_offset_label ), $CONTROL_PAR_POS_Y, 95 )

    set_control_par( get_ui_id( $psyche_delay_cross_fb ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $PsycheDelaySettingsPanel ) )
    set_control_par( get_ui_id( $psyche_delay_cross_fb ), $CONTROL_PAR_POS_X, 72 )
    set_control_par( get_ui_id( $psyche_delay_cross_fb ), $CONTROL_PAR_POS_Y, 115 )

    set_control_par( get_ui_id( $psyche_delay_cross_fb_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $PsycheDelaySettingsPanel ) )
    hide_part( $psyche_delay_cross_fb_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $psyche_delay_cross_fb_label ), $CONTROL_PAR_POS_X, 62 )
    set_control_par( get_ui_id( $psyche_delay_cross_fb_label ), $CONTROL_PAR_POS_Y, 150 )

    set_control_par( get_ui_id( $psyche_delay_pitch ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $PsycheDelaySettingsPanel ) )
    set_control_par( get_ui_id( $psyche_delay_pitch ), $CONTROL_PAR_POS_X, 20 )
    set_control_par( get_ui_id( $psyche_delay_pitch ), $CONTROL_PAR_POS_Y, 60 )

    set_control_par( get_ui_id( $psyche_delay_pitch_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $PsycheDelaySettingsPanel ) )
    hide_part( $psyche_delay_pitch_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $psyche_delay_pitch_label ), $CONTROL_PAR_POS_X, 18 )
    set_control_par( get_ui_id( $psyche_delay_pitch_label ), $CONTROL_PAR_POS_Y, 95 )

    set_control_par( get_ui_id( $psyche_delay_detune ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $PsycheDelaySettingsPanel ) )
    set_control_par( get_ui_id( $psyche_delay_detune ), $CONTROL_PAR_POS_X, 20 )
    set_control_par( get_ui_id( $psyche_delay_detune ), $CONTROL_PAR_POS_Y, 115 )

    set_control_par( get_ui_id( $psyche_delay_detune_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $PsycheDelaySettingsPanel ) )
    hide_part( $psyche_delay_detune_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $psyche_delay_detune_label ), $CONTROL_PAR_POS_X, 14 )
    set_control_par( get_ui_id( $psyche_delay_detune_label ), $CONTROL_PAR_POS_Y, 150 )

    set_control_par( get_ui_id( $psyche_delay_reversed_button ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $PsycheDelaySettingsPanel ) )
    set_control_par( get_ui_id( $psyche_delay_reversed_button ), $CONTROL_PAR_POS_X, 124 )
    set_control_par( get_ui_id( $psyche_delay_reversed_button ), $CONTROL_PAR_POS_Y, 55 )

    set_control_par( get_ui_id( $psyche_delay_bypass_button ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $PsycheDelaySettingsPanel ) )
    set_control_par( get_ui_id( $psyche_delay_bypass_button ), $CONTROL_PAR_POS_X, 132 )
    set_control_par( get_ui_id( $psyche_delay_bypass_button ), $CONTROL_PAR_POS_Y, 165 )

    {Replika Delay slot 2}
    declare ui_button $replika_delay_toggle_button
    set_control_par( get_ui_id( $replika_delay_toggle_button ), $CONTROL_PAR_VALUE, 0)
    set_control_par( get_ui_id( $replika_delay_toggle_button ), $CONTROL_PAR_WIDTH, 70 )
    set_control_par_str( get_ui_id( $replika_delay_toggle_button ), $CONTROL_PAR_TEXT, "Replika Delay" )

    set_control_par( get_ui_id( $replika_delay_toggle_button ), $CONTROL_PAR_POS_X, 310 )
    set_control_par( get_ui_id( $replika_delay_toggle_button ), $CONTROL_PAR_POS_Y, 330 )

    declare ui_slider $replika_delay_amount(0, 1000000) {Replika delay amount}
    declare ui_label $replika_delay_amount_label(1,1)
        set_control_par_str( get_ui_id( $replika_delay_amount_label ), $CONTROL_PAR_TEXT, "AMOUNT" )

    declare ui_slider $replika_delay_time(0, 1000000) {Replika delay time}
    declare ui_label $replika_delay_time_label(1,1)
        set_control_par_str( get_ui_id( $replika_delay_time_label ), $CONTROL_PAR_TEXT, "TIME" )

    declare ui_slider $replika_delay_feedback(0, 1000000) {Replika delay feedback}
    declare ui_label $replika_delay_feedback_label(1,1)
        set_control_par_str( get_ui_id( $replika_delay_feedback_label ), $CONTROL_PAR_TEXT, "FEEDBACK" )
    
    declare ui_slider $replika_delay_depth( 0, 1000000) {Replika delay depth}
    declare ui_label $replika_delay_depth_label(1,1)
        set_control_par_str( get_ui_id( $replika_delay_depth_label ), $CONTROL_PAR_TEXT, "DEPTH" )

    declare ui_slider $replika_delay_rate(0, 1000000) {Replika delay rate}
    declare ui_label $replika_delay_rate_label(1,1)
        set_control_par_str( get_ui_id( $replika_delay_rate_label ), $CONTROL_PAR_TEXT, "RATE" )

    declare ui_slider $replika_delay_saturation(0, 1000000) {Replika delay saturation}
    declare ui_label $replika_delay_saturation_label(1,1)
        set_control_par_str( get_ui_id( $replika_delay_saturation_label ), $CONTROL_PAR_TEXT, "SATURATION" )

    declare ui_slider $replika_delay_filter(0, 1000000) {Replika delay filter}
    declare ui_label $replika_delay_filter_label(1,1)
        set_control_par_str( get_ui_id( $replika_delay_filter_label ), $CONTROL_PAR_TEXT, "FILTER" )

    declare ui_button $replika_delay_bypass_button
    set_control_par( get_ui_id( $replika_delay_bypass_button ), $CONTROL_PAR_WIDTH, 50 )
    set_control_par_str( get_ui_id( $replika_delay_bypass_button ), $CONTROL_PAR_TEXT, "BYPASS" )
    set_control_par( get_ui_id( $replika_delay_bypass_button ), $CONTROL_PAR_VALUE, 1 )
    set_engine_par( $ENGINE_PAR_SEND_EFFECT_BYPASS, $replika_delay_bypass_button, -1, 1, $NI_SEND_BUS )

    {Replika Delay Settings Panel}
    declare ui_panel $ReplikaDelaySettingsPanel
    set_control_par( get_ui_id( $ReplikaDelaySettingsPanel ), $CONTROL_PAR_HIDE, $HIDE_WHOLE_CONTROL )
    set_control_par( get_ui_id( $ReplikaDelaySettingsPanel ), $CONTROL_PAR_POS_X, 244 )
    set_control_par( get_ui_id( $ReplikaDelaySettingsPanel ), $CONTROL_PAR_POS_Y, 300 )

    set_control_par( get_ui_id( $replika_delay_amount ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $ReplikaDelaySettingsPanel ) )
    set_control_par( get_ui_id( $replika_delay_amount ), $CONTROL_PAR_POS_X, 120 )
    set_control_par( get_ui_id( $replika_delay_amount ), $CONTROL_PAR_POS_Y, 75 )

    set_control_par( get_ui_id( $replika_delay_amount_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $ReplikaDelaySettingsPanel ) )
    hide_part( $replika_delay_amount_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $replika_delay_amount_label ), $CONTROL_PAR_POS_X, 132 )
    set_control_par( get_ui_id( $replika_delay_amount_label ), $CONTROL_PAR_POS_Y, 140 )

    set_control_par( get_ui_id( $replika_delay_time ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $ReplikaDelaySettingsPanel ) )
    set_control_par( get_ui_id( $replika_delay_time ), $CONTROL_PAR_POS_X, 200 )
    set_control_par( get_ui_id( $replika_delay_time ), $CONTROL_PAR_POS_Y, 115 )

    set_control_par( get_ui_id( $replika_delay_time_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $ReplikaDelaySettingsPanel ) )
    hide_part( $replika_delay_time_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $replika_delay_time_label ), $CONTROL_PAR_POS_X, 200 )
    set_control_par( get_ui_id( $replika_delay_time_label ), $CONTROL_PAR_POS_Y, 150 )

    set_control_par( get_ui_id( $replika_delay_feedback ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $ReplikaDelaySettingsPanel ) )
    set_control_par( get_ui_id( $replika_delay_feedback ), $CONTROL_PAR_POS_X, 200 )
    set_control_par( get_ui_id( $replika_delay_feedback ), $CONTROL_PAR_POS_Y, 60 )

    set_control_par( get_ui_id( $replika_delay_feedback_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $ReplikaDelaySettingsPanel ) )
    hide_part( $replika_delay_feedback_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $replika_delay_feedback_label ), $CONTROL_PAR_POS_X, 188 )
    set_control_par( get_ui_id( $replika_delay_feedback_label ), $CONTROL_PAR_POS_Y, 95 )

    set_control_par( get_ui_id( $replika_delay_depth ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $ReplikaDelaySettingsPanel ) )
    set_control_par( get_ui_id( $replika_delay_depth ), $CONTROL_PAR_POS_X, 72 )
    set_control_par( get_ui_id( $replika_delay_depth ), $CONTROL_PAR_POS_Y, 60 )

    set_control_par( get_ui_id( $replika_delay_depth_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $ReplikaDelaySettingsPanel ) )
    hide_part( $replika_delay_depth_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $replika_delay_depth_label ), $CONTROL_PAR_POS_X, 70 )
    set_control_par( get_ui_id( $replika_delay_depth_label ), $CONTROL_PAR_POS_Y, 95 )

    set_control_par( get_ui_id( $replika_delay_rate ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $ReplikaDelaySettingsPanel ) )
    set_control_par( get_ui_id( $replika_delay_rate ), $CONTROL_PAR_POS_X, 72 )
    set_control_par( get_ui_id( $replika_delay_rate ), $CONTROL_PAR_POS_Y, 115 )

    set_control_par( get_ui_id( $replika_delay_rate_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $ReplikaDelaySettingsPanel ) )
    hide_part( $replika_delay_rate_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $replika_delay_rate_label ), $CONTROL_PAR_POS_X, 73 )
    set_control_par( get_ui_id( $replika_delay_rate_label ), $CONTROL_PAR_POS_Y, 150 )

    set_control_par( get_ui_id( $replika_delay_saturation ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $ReplikaDelaySettingsPanel ) )
    set_control_par( get_ui_id( $replika_delay_saturation ), $CONTROL_PAR_POS_X, 20 )
    set_control_par( get_ui_id( $replika_delay_saturation ), $CONTROL_PAR_POS_Y, 60 )

    set_control_par( get_ui_id( $replika_delay_saturation_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $ReplikaDelaySettingsPanel ) )
    hide_part( $replika_delay_saturation_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $replika_delay_saturation_label ), $CONTROL_PAR_POS_X, 3 )
    set_control_par( get_ui_id( $replika_delay_saturation_label ), $CONTROL_PAR_POS_Y, 95 )

    set_control_par( get_ui_id( $replika_delay_filter ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $ReplikaDelaySettingsPanel ) )
    set_control_par( get_ui_id( $replika_delay_filter ), $CONTROL_PAR_POS_X, 20 )
    set_control_par( get_ui_id( $replika_delay_filter ), $CONTROL_PAR_POS_Y, 115 )

    set_control_par( get_ui_id( $replika_delay_filter_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $ReplikaDelaySettingsPanel ) )
    hide_part( $replika_delay_filter_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $replika_delay_filter_label ), $CONTROL_PAR_POS_X, 18 )
    set_control_par( get_ui_id( $replika_delay_filter_label ), $CONTROL_PAR_POS_Y, 150 )

    set_control_par( get_ui_id( $replika_delay_bypass_button ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $ReplikaDelaySettingsPanel ) )
    set_control_par( get_ui_id( $replika_delay_bypass_button ), $CONTROL_PAR_POS_X, 132 )
    set_control_par( get_ui_id( $replika_delay_bypass_button ), $CONTROL_PAR_POS_Y, 165 )



    {Effects Panel}
    declare ui_panel $EffectsSettingsPanel
        {Reverb}
    declare $reverb_move := 113
    set_control_par( get_ui_id( $reverb_amount ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $EffectsSettingsPanel ) )
    set_control_par( get_ui_id( $reverb_amount ), $CONTROL_PAR_POS_X, 500 + $reverb_move )
    set_control_par( get_ui_id( $reverb_amount ), $CONTROL_PAR_POS_Y, 375 )

    set_control_par( get_ui_id( $reverb_amount_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $EffectsSettingsPanel ) )
    hide_part( $reverb_amount_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $reverb_amount_label ), $CONTROL_PAR_POS_X, 512 + $reverb_move )
    set_control_par( get_ui_id( $reverb_amount_label ), $CONTROL_PAR_POS_Y, 440 )


    set_control_par( get_ui_id( $reverb_pre_delay ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $EffectsSettingsPanel ) )
    set_control_par( get_ui_id( $reverb_pre_delay ), $CONTROL_PAR_POS_X, 580 + $reverb_move )
    set_control_par( get_ui_id( $reverb_pre_delay ), $CONTROL_PAR_POS_Y, 360 )

    set_control_par( get_ui_id( $reverb_pre_delay_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $EffectsSettingsPanel ) )
    hide_part( $reverb_pre_delay_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $reverb_pre_delay_label ), $CONTROL_PAR_POS_X, 568 + $reverb_move )
    set_control_par( get_ui_id( $reverb_pre_delay_label ), $CONTROL_PAR_POS_Y, 395 )


    set_control_par( get_ui_id( $reverb_time ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $EffectsSettingsPanel ) )
    set_control_par( get_ui_id( $reverb_time ), $CONTROL_PAR_POS_X, 580 + $reverb_move )
    set_control_par( get_ui_id( $reverb_time ), $CONTROL_PAR_POS_Y, 415 )

    set_control_par( get_ui_id( $reverb_time_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $EffectsSettingsPanel ) )
    hide_part( $reverb_time_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $reverb_time_label ), $CONTROL_PAR_POS_X, 580 + $reverb_move )
    set_control_par( get_ui_id( $reverb_time_label ), $CONTROL_PAR_POS_Y, 450 )


    set_control_par( get_ui_id( $reverb_size ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $EffectsSettingsPanel ) )
    set_control_par( get_ui_id( $reverb_size ), $CONTROL_PAR_POS_X, 400 + $reverb_move )
    set_control_par( get_ui_id( $reverb_size ), $CONTROL_PAR_POS_Y, 360 )

    set_control_par( get_ui_id( $reverb_size_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $EffectsSettingsPanel ) )
    hide_part( $reverb_size_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $reverb_size_label ), $CONTROL_PAR_POS_X, 402 + $reverb_move )
    set_control_par( get_ui_id( $reverb_size_label ), $CONTROL_PAR_POS_Y, 395 )


    set_control_par( get_ui_id( $reverb_stereo ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $EffectsSettingsPanel ) )
    set_control_par( get_ui_id( $reverb_stereo ), $CONTROL_PAR_POS_X, 400 + $reverb_move )
    set_control_par( get_ui_id( $reverb_stereo ), $CONTROL_PAR_POS_Y, 415 )

    set_control_par( get_ui_id( $reverb_stereo_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $EffectsSettingsPanel ) )
    hide_part( $reverb_stereo_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $reverb_stereo_label ), $CONTROL_PAR_POS_X, 395 + $reverb_move )
    set_control_par( get_ui_id( $reverb_stereo_label ), $CONTROL_PAR_POS_Y, 450 )


    set_control_par( get_ui_id( $reverb_low_shelf ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $EffectsSettingsPanel ) )
    set_control_par( get_ui_id( $reverb_low_shelf ), $CONTROL_PAR_POS_X, 452 + $reverb_move )
    set_control_par( get_ui_id( $reverb_low_shelf ), $CONTROL_PAR_POS_Y, 360 )

    set_control_par( get_ui_id( $reverb_low_shelf_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $EffectsSettingsPanel ) )
    hide_part( $reverb_low_shelf_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $reverb_low_shelf_label ), $CONTROL_PAR_POS_X, 440 + $reverb_move )
    set_control_par( get_ui_id( $reverb_low_shelf_label ), $CONTROL_PAR_POS_Y, 395 )


    set_control_par( get_ui_id( $reverb_high_cut ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $EffectsSettingsPanel ) )
    set_control_par( get_ui_id( $reverb_high_cut ), $CONTROL_PAR_POS_X, 452 + $reverb_move )
    set_control_par( get_ui_id( $reverb_high_cut ), $CONTROL_PAR_POS_Y, 415 )
    
    set_control_par( get_ui_id( $reverb_high_cut_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $EffectsSettingsPanel ) )
    hide_part( $reverb_high_cut_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $reverb_high_cut_label ), $CONTROL_PAR_POS_X, 445 + $reverb_move )
    set_control_par( get_ui_id( $reverb_high_cut_label ), $CONTROL_PAR_POS_Y, 450 )

    set_control_par( get_ui_id( $reverb_bypass_button ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $EffectsSettingsPanel ) )
    set_control_par( get_ui_id( $reverb_bypass_button ), $CONTROL_PAR_POS_X, 512 + $reverb_move )
    set_control_par( get_ui_id( $reverb_bypass_button ), $CONTROL_PAR_POS_Y, 465 )

        {Filter}
    set_control_par( get_ui_id( $filter_lowcut ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $EffectsSettingsPanel ) )
    set_control_par( get_ui_id( $filter_lowcut ), $CONTROL_PAR_POS_X, 800 - 40 )
    set_control_par( get_ui_id( $filter_lowcut ), $CONTROL_PAR_POS_Y, 350 )

    set_control_par( get_ui_id( $filter_lowcut_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $EffectsSettingsPanel ) )
    hide_part( $filter_lowcut_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $filter_lowcut_label ), $CONTROL_PAR_POS_X, 855 - 40)
    set_control_par( get_ui_id( $filter_lowcut_label ), $CONTROL_PAR_POS_Y, 368 )

    set_control_par( get_ui_id( $filter_lowcut_resonance ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $EffectsSettingsPanel ) )
    set_control_par( get_ui_id( $filter_lowcut_resonance ), $CONTROL_PAR_POS_X, 770 )
    set_control_par( get_ui_id( $filter_lowcut_resonance ), $CONTROL_PAR_POS_Y, 425 )

    set_control_par( get_ui_id( $filter_lowcut_resonance_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $EffectsSettingsPanel ) )
    hide_part( $filter_lowcut_resonance_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $filter_lowcut_resonance_label ), $CONTROL_PAR_POS_X, 815)
    set_control_par( get_ui_id( $filter_lowcut_resonance_label ), $CONTROL_PAR_POS_Y, 432 )


    set_control_par( get_ui_id( $filter_highcut ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $EffectsSettingsPanel ) )
    set_control_par( get_ui_id( $filter_highcut ), $CONTROL_PAR_POS_X, 875 )
    set_control_par( get_ui_id( $filter_highcut ), $CONTROL_PAR_POS_Y, 350 )

    set_control_par( get_ui_id( $filter_highcut_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $EffectsSettingsPanel ) )
    hide_part( $filter_highcut_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $filter_highcut_label ), $CONTROL_PAR_POS_X, 930)
    set_control_par( get_ui_id( $filter_highcut_label ), $CONTROL_PAR_POS_Y, 368 )


    set_control_par( get_ui_id( $filter_highcut_resonance ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $EffectsSettingsPanel ) )
    set_control_par( get_ui_id( $filter_highcut_resonance ), $CONTROL_PAR_POS_X, 885 )
    set_control_par( get_ui_id( $filter_highcut_resonance ), $CONTROL_PAR_POS_Y, 425 )

    set_control_par( get_ui_id( $filter_highcut_resonance_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $EffectsSettingsPanel ) )
    hide_part( $filter_highcut_resonance_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $filter_highcut_resonance_label ), $CONTROL_PAR_POS_X, 930)
    set_control_par( get_ui_id( $filter_highcut_resonance_label ), $CONTROL_PAR_POS_Y, 432 )

    set_control_par( get_ui_id( $filter_bypass_button ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $EffectsSettingsPanel ) )
    set_control_par( get_ui_id( $filter_bypass_button ), $CONTROL_PAR_POS_X, 875 - 40 )
    set_control_par( get_ui_id( $filter_bypass_button ), $CONTROL_PAR_POS_Y, 465 )




    {Envelope Parameters}
    declare ui_slider $amp_env_attack(0, 440650)        {Attack time. 440650 corresponds to 1000ms}
    declare ui_slider $amp_env_decay(0, 416791)         {Decay time. 416791 corresponds to 1000ms}

    declare ui_label $amp_env_attack_label(1,1)
    set_control_par_str( get_ui_id( $amp_env_attack_label ), $CONTROL_PAR_TEXT, "Attack" )
    declare ui_label $amp_env_decay_label(1,1)
    set_control_par_str( get_ui_id( $amp_env_decay_label ), $CONTROL_PAR_TEXT, "Decay" )




    {Default Values}
    set_control_par( get_ui_id( $grainAmount ), $CONTROL_PAR_DEFAULT_VALUE, 10 ) {Default grains per second}
    $timebetweenGrains := 1000000 / get_control_par(get_ui_id($grainAmount), $CONTROL_PAR_DEFAULT_VALUE) {Default time between grains in microseconds}
    set_control_par(get_ui_id($grainDuration), $CONTROL_PAR_DEFAULT_VALUE, 440650) {Default grain duration in milliseconds}
    set_control_par( get_ui_id($width_knob), $CONTROL_PAR_DEFAULT_VALUE, 500 )
    
    set_control_par( get_ui_id( $amp_env_attack ), $CONTROL_PAR_DEFAULT_VALUE, 200807 ) {Default attack value (200807 corresponds to 10ms)}
    set_control_par( get_ui_id( $amp_env_decay ), $CONTROL_PAR_DEFAULT_VALUE, 189935 ) {Default decay value (189935 corresponds to 10ms)}

    set_control_par( get_ui_id( $kalimba_volume ), $CONTROL_PAR_DEFAULT_VALUE, 629961 ) {Default volume for Kalimba (629961 corresponds to 0.0 dB)}
    set_control_par( get_ui_id( $rain_stick_volume ), $CONTROL_PAR_DEFAULT_VALUE, 629961 ) {Default volume for Rain Stick (629961 corresponds to 0.0 dB)}
    set_control_par( get_ui_id( $native_flute_volume ), $CONTROL_PAR_DEFAULT_VALUE, 629961 ) {Default volume for nat flute (629961 corresponds to 0.0 dB)}
    set_control_par( get_ui_id( $guitar_volume ), $CONTROL_PAR_DEFAULT_VALUE, 629961 ) {Default volume for guitar (629961 corresponds to 0.0 dB)}
    set_control_par( get_ui_id( $vocal_volume ), $CONTROL_PAR_DEFAULT_VALUE, 629961 ) {Default volume for guitar (629961 corresponds to 0.0 dB)}
    set_control_par( get_ui_id( $sawpluck_volume ), $CONTROL_PAR_DEFAULT_VALUE, 629961 ) {Default volume for guitar (629961 corresponds to 0.0 dB)}
    set_control_par( get_ui_id( $piano_volume ), $CONTROL_PAR_DEFAULT_VALUE, 629961 ) {Default volume for guitar (629961 corresponds to 0.0 dB)}
    set_control_par( get_ui_id( $ethereal_volume ), $CONTROL_PAR_DEFAULT_VALUE, 629961 ) {Default volume for synth (629961 corresponds to 0.0 dB)}
    set_control_par( get_ui_id( $sinepluck_volume ), $CONTROL_PAR_DEFAULT_VALUE, 629961 ) {Default volume for synth (629961 corresponds to 0.0 dB)}
    set_control_par( get_ui_id( $waterdrop_volume ), $CONTROL_PAR_DEFAULT_VALUE, 629961 ) {Default volume for synth (629961 corresponds to 0.0 dB)}

        {LFO}
    set_control_par( get_ui_id( $lfo_freq ), $CONTROL_PAR_DEFAULT_VALUE, 0 ) {Default LFO frequency}
    set_control_par( get_ui_id( $lfo_depth ), $CONTROL_PAR_DEFAULT_VALUE, 500000 ) {Default LFO depth (500000 corresponds to 0% depth)}

        {Reverb}
    set_control_par( get_ui_id( $reverb_amount ), $CONTROL_PAR_DEFAULT_VALUE, 200000)       {Default reverb amount}
    set_control_par( get_ui_id( $reverb_pre_delay ), $CONTROL_PAR_DEFAULT_VALUE, 80000 )    {Default pre-delay for reverb (80000 corresponds to 20ms)}
    set_control_par( get_ui_id( $reverb_time ), $CONTROL_PAR_DEFAULT_VALUE, 484259 )       {Default reverb time (200000 corresponds to 3 seconds)}
    set_control_par( get_ui_id( $reverb_size ), $CONTROL_PAR_DEFAULT_VALUE, 1000000 )    {Default reverb size (1000000 corresponds to 100% size)}
    set_control_par( get_ui_id( $reverb_stereo ), $CONTROL_PAR_DEFAULT_VALUE, 1000000 )    {Default reverb stereo width (500000 corresponds to 50% stereo width)}
    set_control_par( get_ui_id( $reverb_low_shelf ), $CONTROL_PAR_DEFAULT_VALUE, 750000 )   {Default reverb low shelf (750000 corresponds to -9.0 dB)}
    set_control_par( get_ui_id( $reverb_high_cut ), $CONTROL_PAR_DEFAULT_VALUE, 1000000 )   {Default reverb high cut (1000000 corresponds to 21 kHz)}

        {Filter}
    set_control_par( get_ui_id( $filter_lowcut ), $CONTROL_PAR_DEFAULT_VALUE, 0 ) {Default filter low cut (0 corresponds to 20 Hz)}
    set_control_par( get_ui_id( $filter_highcut ), $CONTROL_PAR_DEFAULT_VALUE, 1000000 ) {Default filter high cut (1000000 corresponds to 20 kHz)}

        {Psyche Delay}
    set_control_par( get_ui_id( $psyche_delay_amount ), $CONTROL_PAR_DEFAULT_VALUE, 200000 ) {Default psyche delay amount}
    set_control_par( get_ui_id( $psyche_delay_time ), $CONTROL_PAR_DEFAULT_VALUE, 250000 ) {Default psyche delay time (500000 corresponds to 500 ms)}
    set_control_par( get_ui_id( $psyche_delay_feedback ), $CONTROL_PAR_DEFAULT_VALUE, 500000 ) {Default psyche delay feedback (500000 corresponds to 50% feedback)}
    set_control_par( get_ui_id( $psyche_delay_lr_offset ), $CONTROL_PAR_DEFAULT_VALUE, 500000 ) {Default psyche delay left/right offset (500000 corresponds to 50% offset)}
    set_control_par( get_ui_id( $psyche_delay_cross_fb ), $CONTROL_PAR_DEFAULT_VALUE, 500000 ) {Default psyche delay cross feedback (500000 corresponds to 50% cross feedback)}
    set_control_par( get_ui_id( $psyche_delay_pitch ), $CONTROL_PAR_DEFAULT_VALUE, 500000 ) {Default psyche delay pitch (500000 corresponds to 0.0 semitones)}
    set_control_par( get_ui_id( $psyche_delay_detune ), $CONTROL_PAR_DEFAULT_VALUE, 500000 ) {Default psyche delay detune (500000 corresponds to 0.0 cents)}

        {Replika Delay}
    set_control_par( get_ui_id( $replika_delay_amount ), $CONTROL_PAR_DEFAULT_VALUE, 200000 ) {Default replika delay amount}
    set_control_par( get_ui_id( $replika_delay_time ), $CONTROL_PAR_DEFAULT_VALUE, 250000 ) {Default replika delay time (500000 corresponds to 500 ms)}
    set_control_par( get_ui_id( $replika_delay_feedback ), $CONTROL_PAR_DEFAULT_VALUE, 416667 ) {Default replika delay feedback (500000 corresponds to 50% feedback)}
    set_control_par( get_ui_id( $replika_delay_filter ), $CONTROL_PAR_DEFAULT_VALUE, 500000 ) {Default replika delay depth (500000 corresponds to 50% depth)}



    {Granular Settings Panel}
    set_control_par( get_ui_id( $grainAmount ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $GrainSettingsPanel ) )
    set_control_par( get_ui_id( $grainDuration ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $GrainSettingsPanel ) )

    set_control_par( get_ui_id( $width_knob ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $GrainSettingsPanel ) )
    set_control_par( get_ui_id( $width_knob ), $CONTROL_PAR_POS_X, 110 )

    set_control_par( get_ui_id( $grainAmount ), $CONTROL_PAR_POS_X, 0 )
    set_control_par( get_ui_id( $grainDuration ), $CONTROL_PAR_POS_Y, 60 )

    set_control_par( get_ui_id( $grainAmount_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $GrainSettingsPanel ) )
    hide_part( $grainAmount_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $grainAmount_label ), $CONTROL_PAR_POS_X, 60)
    set_control_par( get_ui_id( $grainAmount_label ), $CONTROL_PAR_POS_Y, 25 )

    set_control_par( get_ui_id( $grainDuration_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $GrainSettingsPanel ) )
    hide_part( $grainDuration_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $grainDuration_label ), $CONTROL_PAR_POS_X, 58 )
    set_control_par( get_ui_id( $grainDuration_label ), $CONTROL_PAR_POS_Y, 85 )

    set_control_par( get_ui_id( $width_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $GrainSettingsPanel ) )
    hide_part( $width_label, $HIDE_PART_BG )
    set_control_par( get_ui_id( $width_label ), $CONTROL_PAR_POS_X, 167 )
    set_control_par( get_ui_id( $width_label ), $CONTROL_PAR_POS_Y, 25 )




    {Envelope Settings Panel}
    set_control_par( get_ui_id( $amp_env_attack ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $EnvelopeSettingsPanel ) )
    set_control_par( get_ui_id( $amp_env_decay ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $EnvelopeSettingsPanel ) )

    set_control_par( get_ui_id( $amp_env_attack ), $CONTROL_PAR_POS_X, 3 )
    set_control_par( get_ui_id( $amp_env_attack ), $CONTROL_PAR_POS_Y, 28 )
    set_control_par( get_ui_id( $amp_env_decay ), $CONTROL_PAR_POS_X, 48 )
    set_control_par( get_ui_id( $amp_env_decay ), $CONTROL_PAR_POS_Y, 28 )

    set_control_par( get_ui_id( $amp_env_attack_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $EnvelopeSettingsPanel ) )
    set_control_par( get_ui_id( $amp_env_decay_label ), $CONTROL_PAR_PARENT_PANEL, get_ui_id( $EnvelopeSettingsPanel ) )

    hide_part ($amp_env_attack_label,$HIDE_PART_BG)
    set_control_par( get_ui_id( $amp_env_attack_label ), $CONTROL_PAR_POS_X, 0 )
    set_control_par( get_ui_id( $amp_env_attack_label ), $CONTROL_PAR_POS_Y, 68 )

    hide_part ($amp_env_decay_label,$HIDE_PART_BG) 
    set_control_par( get_ui_id( $amp_env_decay_label ), $CONTROL_PAR_POS_X, 46 )
    set_control_par( get_ui_id( $amp_env_decay_label ), $CONTROL_PAR_POS_Y, 68 )




    {Changing pictures}
    set_control_par_str(get_ui_id($grainAmount), $CONTROL_PAR_PICTURE, "knob")
    set_control_par_str( get_ui_id( $grainDuration ), $CONTROL_PAR_PICTURE, "knob" )
    set_control_par_str( get_ui_id($width_knob), $CONTROL_PAR_PICTURE, "knob")

    set_control_par_str(get_ui_id( $amp_env_attack ), $CONTROL_PAR_PICTURE, "attack_decay_knob")
    set_control_par_str(get_ui_id($amp_env_decay), $CONTROL_PAR_PICTURE, "attack_decay_knob")

        {Kalimba}
    set_control_par_str(get_ui_id($kalimba_position), $CONTROL_PAR_PICTURE, "attack_decay_knob")
    set_control_par_str(get_ui_id($kalimba_position_random), $CONTROL_PAR_PICTURE, "attack_decay_knob")
    set_control_par_str(get_ui_id($kalimba_volume), $CONTROL_PAR_PICTURE, "attack_decay_knob")

        {Rain Stick}
    set_control_par_str(get_ui_id($rain_stick_position), $CONTROL_PAR_PICTURE, "attack_decay_knob")
    set_control_par_str(get_ui_id($rain_stick_position_random), $CONTROL_PAR_PICTURE, "attack_decay_knob")
    set_control_par_str(get_ui_id($rain_stick_volume), $CONTROL_PAR_PICTURE, "attack_decay_knob")

        {Native Flute}
    set_control_par_str(get_ui_id($native_flute_position), $CONTROL_PAR_PICTURE, "attack_decay_knob")
    set_control_par_str(get_ui_id($native_flute_position_random), $CONTROL_PAR_PICTURE, "attack_decay_knob")
    set_control_par_str(get_ui_id($native_flute_volume), $CONTROL_PAR_PICTURE, "attack_decay_knob")

        {Guitar}
    set_control_par_str(get_ui_id($guitar_position), $CONTROL_PAR_PICTURE, "attack_decay_knob")
    set_control_par_str(get_ui_id($guitar_position_random), $CONTROL_PAR_PICTURE, "attack_decay_knob")
    set_control_par_str(get_ui_id($guitar_volume), $CONTROL_PAR_PICTURE, "attack_decay_knob")

        {Vocal}
    set_control_par_str(get_ui_id($vocal_position), $CONTROL_PAR_PICTURE, "attack_decay_knob")
    set_control_par_str(get_ui_id($vocal_position_random), $CONTROL_PAR_PICTURE, "attack_decay_knob")
    set_control_par_str(get_ui_id($vocal_volume), $CONTROL_PAR_PICTURE, "attack_decay_knob")

        {Saw Pluck}
    set_control_par_str(get_ui_id($sawpluck_position), $CONTROL_PAR_PICTURE, "attack_decay_knob")
    set_control_par_str(get_ui_id($sawpluck_position_random), $CONTROL_PAR_PICTURE, "attack_decay_knob")
    set_control_par_str(get_ui_id($sawpluck_volume), $CONTROL_PAR_PICTURE, "attack_decay_knob")

        {Piano}
    set_control_par_str(get_ui_id($piano_position), $CONTROL_PAR_PICTURE, "attack_decay_knob")
    set_control_par_str(get_ui_id($piano_position_random), $CONTROL_PAR_PICTURE, "attack_decay_knob")
    set_control_par_str(get_ui_id($piano_volume), $CONTROL_PAR_PICTURE, "attack_decay_knob")

        {Ethereal Lead}
    set_control_par_str(get_ui_id($ethereal_position), $CONTROL_PAR_PICTURE, "attack_decay_knob")
    set_control_par_str(get_ui_id($ethereal_position_random), $CONTROL_PAR_PICTURE, "attack_decay_knob")
    set_control_par_str(get_ui_id($ethereal_volume), $CONTROL_PAR_PICTURE, "attack_decay_knob")

        {Sine Pluck}
    set_control_par_str(get_ui_id($sinepluck_position), $CONTROL_PAR_PICTURE, "attack_decay_knob")
    set_control_par_str(get_ui_id($sinepluck_position_random), $CONTROL_PAR_PICTURE, "attack_decay_knob")
    set_control_par_str(get_ui_id($sinepluck_volume), $CONTROL_PAR_PICTURE, "attack_decay_knob")

        {Water Drop}
    set_control_par_str(get_ui_id($waterdrop_position), $CONTROL_PAR_PICTURE, "attack_decay_knob")
    set_control_par_str(get_ui_id($waterdrop_position_random), $CONTROL_PAR_PICTURE, "attack_decay_knob")
    set_control_par_str(get_ui_id($waterdrop_volume), $CONTROL_PAR_PICTURE, "attack_decay_knob")

        {LFO}
    set_control_par_str(get_ui_id($lfo_freq), $CONTROL_PAR_PICTURE, "attack_decay_knob")
    set_control_par_str(get_ui_id($lfo_depth), $CONTROL_PAR_PICTURE, "knob")
    set_control_par_str(get_ui_id($lfo_fade_in), $CONTROL_PAR_PICTURE, "attack_decay_knob")

        {Reverb}
    set_control_par_str(get_ui_id($reverb_amount), $CONTROL_PAR_PICTURE, "knob")
    set_control_par_str(get_ui_id($reverb_pre_delay), $CONTROL_PAR_PICTURE, "attack_decay_knob")
    set_control_par_str(get_ui_id($reverb_time), $CONTROL_PAR_PICTURE, "attack_decay_knob")
    set_control_par_str(get_ui_id($reverb_size), $CONTROL_PAR_PICTURE, "attack_decay_knob")
    set_control_par_str(get_ui_id($reverb_stereo), $CONTROL_PAR_PICTURE, "attack_decay_knob")
    set_control_par_str(get_ui_id($reverb_low_shelf), $CONTROL_PAR_PICTURE, "attack_decay_knob")
    set_control_par_str(get_ui_id($reverb_high_cut), $CONTROL_PAR_PICTURE, "attack_decay_knob")

        {Filter}
    set_control_par_str(get_ui_id($filter_lowcut), $CONTROL_PAR_PICTURE, "knob2")
    set_control_par_str(get_ui_id($filter_lowcut_resonance), $CONTROL_PAR_PICTURE, "attack_decay_knob")
    set_control_par_str(get_ui_id($filter_highcut), $CONTROL_PAR_PICTURE, "knob2")
    set_control_par_str(get_ui_id($filter_highcut_resonance), $CONTROL_PAR_PICTURE, "attack_decay_knob")

    {Psyche Delay}
    set_control_par_str(get_ui_id($psyche_delay_amount), $CONTROL_PAR_PICTURE, "knob")
    set_control_par_str(get_ui_id($psyche_delay_time), $CONTROL_PAR_PICTURE, "attack_decay_knob")
    set_control_par_str(get_ui_id($psyche_delay_feedback), $CONTROL_PAR_PICTURE, "attack_decay_knob")
    set_control_par_str(get_ui_id($psyche_delay_lr_offset), $CONTROL_PAR_PICTURE, "attack_decay_knob")
    set_control_par_str(get_ui_id($psyche_delay_cross_fb), $CONTROL_PAR_PICTURE, "attack_decay_knob")
    set_control_par_str(get_ui_id($psyche_delay_pitch), $CONTROL_PAR_PICTURE, "attack_decay_knob")
    set_control_par_str(get_ui_id($psyche_delay_detune), $CONTROL_PAR_PICTURE, "attack_decay_knob")
    
    {Replika Delay}
    set_control_par_str(get_ui_id($replika_delay_amount), $CONTROL_PAR_PICTURE, "knob")
    set_control_par_str(get_ui_id($replika_delay_time), $CONTROL_PAR_PICTURE, "attack_decay_knob")
    set_control_par_str(get_ui_id($replika_delay_feedback), $CONTROL_PAR_PICTURE, "attack_decay_knob")
    set_control_par_str(get_ui_id($replika_delay_depth), $CONTROL_PAR_PICTURE, "attack_decay_knob")
    set_control_par_str(get_ui_id($replika_delay_rate), $CONTROL_PAR_PICTURE, "attack_decay_knob")
    set_control_par_str(get_ui_id($replika_delay_saturation), $CONTROL_PAR_PICTURE, "attack_decay_knob")
    set_control_par_str(get_ui_id($replika_delay_filter), $CONTROL_PAR_PICTURE, "attack_decay_knob")


    {Mouse Controls/Behaviour}
    declare const $mouse_behaviour := -1050
    set_control_par(get_ui_id($grainAmount), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par(get_ui_id($grainDuration), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour + 500)
    set_control_par(get_ui_id($width_knob), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)

    set_control_par(get_ui_id($amp_env_attack), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par(get_ui_id($amp_env_decay), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)

    set_control_par(get_ui_id($kalimba_position), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par(get_ui_id($kalimba_position_random), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par(get_ui_id($kalimba_volume), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)

    set_control_par( get_ui_id($rain_stick_position), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par( get_ui_id($rain_stick_position_random), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par( get_ui_id($rain_stick_volume), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)

    set_control_par(get_ui_id($native_flute_position), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par(get_ui_id($native_flute_position_random), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par(get_ui_id($native_flute_volume), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)

    set_control_par(get_ui_id($guitar_position), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par(get_ui_id($guitar_position_random), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par(get_ui_id($guitar_volume), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)

    set_control_par(get_ui_id($vocal_position), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par(get_ui_id($vocal_position_random), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par(get_ui_id($vocal_volume), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)

    set_control_par(get_ui_id($sawpluck_position), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par(get_ui_id($sawpluck_position_random), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par(get_ui_id($sawpluck_volume), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)

    set_control_par(get_ui_id($piano_position), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par(get_ui_id($piano_position_random), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par(get_ui_id($piano_volume), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)

    set_control_par(get_ui_id($ethereal_position), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par(get_ui_id($ethereal_position_random), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par(get_ui_id($ethereal_volume), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)

    set_control_par(get_ui_id($sinepluck_position), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par(get_ui_id($sinepluck_position_random), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par(get_ui_id($sinepluck_volume), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)

    set_control_par(get_ui_id($waterdrop_position), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par(get_ui_id($waterdrop_position_random), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par(get_ui_id($waterdrop_volume), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)

        {LFO}
    set_control_par(get_ui_id($lfo_freq), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par(get_ui_id($lfo_depth), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par(get_ui_id($lfo_fade_in), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)

        {Reverb}
    set_control_par(get_ui_id($reverb_amount), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par(get_ui_id($reverb_pre_delay), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par(get_ui_id($reverb_time), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour + 900)
    set_control_par(get_ui_id($reverb_size), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par(get_ui_id($reverb_stereo), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par(get_ui_id($reverb_low_shelf), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par(get_ui_id($reverb_high_cut), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)

        {Filter}
    set_control_par(get_ui_id($filter_lowcut), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par(get_ui_id($filter_lowcut_resonance), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par(get_ui_id($filter_highcut), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par(get_ui_id($filter_highcut_resonance), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)

        {Psyche Delay}
    set_control_par(get_ui_id($psyche_delay_amount), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par(get_ui_id($psyche_delay_time), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour + 900)
    set_control_par(get_ui_id($psyche_delay_feedback), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par(get_ui_id($psyche_delay_lr_offset), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par(get_ui_id($psyche_delay_cross_fb), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par(get_ui_id($psyche_delay_pitch), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par(get_ui_id($psyche_delay_detune), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)

        {Replika Delay}
    set_control_par(get_ui_id($replika_delay_amount), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par(get_ui_id($replika_delay_time), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour + 900)
    set_control_par(get_ui_id($replika_delay_feedback), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par(get_ui_id($replika_delay_depth), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par(get_ui_id($replika_delay_rate), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par(get_ui_id($replika_delay_saturation), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)
    set_control_par(get_ui_id($replika_delay_filter), $CONTROL_PAR_MOUSE_BEHAVIOUR, $mouse_behaviour)


    {Persistency}
    make_persistent( $grainAmount )
    make_persistent( $grainDuration )
    make_persistent( $width_knob )
    
    make_persistent( $grainAmount_label)
    make_persistent( $grainDuration_label)
    make_persistent( $width_label )

    make_persistent( $amp_env_attack )
    make_persistent( $amp_env_decay )

    make_persistent( $kalimba_toggle_button )
    make_persistent( $kalimba_reverse_button )
    make_persistent( $kalimba_position )
    make_persistent( $kalimba_position_random )
    make_persistent( $kalimba_volume )

    make_persistent( $rain_stick_toggle_button )
    make_persistent( $rain_stick_reverse_button )
    make_persistent( $rain_stick_position )
    make_persistent( $rain_stick_position_random ) 
    make_persistent( $rain_stick_volume )

    make_persistent( $native_flute_toggle_button )
    make_persistent( $native_flute_reverse_button )
    make_persistent( $native_flute_position )
    make_persistent( $native_flute_position_random )
    make_persistent( $native_flute_volume )

    make_persistent( $guitar_toggle_button )
    make_persistent( $guitar_reverse_button )
    make_persistent( $guitar_position )
    make_persistent( $guitar_position_random )
    make_persistent( $guitar_volume )

    make_persistent( $vocal_toggle_button )
    make_persistent( $vocal_reverse_button )
    make_persistent( $vocal_position )
    make_persistent( $vocal_position_random )
    make_persistent( $vocal_volume )

    make_persistent( $sawpluck_toggle_button )
    make_persistent( $sawpluck_reverse_button )
    make_persistent( $sawpluck_position )
    make_persistent( $sawpluck_position_random )
    make_persistent( $sawpluck_volume )

    make_persistent( $piano_toggle_button )
    make_persistent( $piano_reverse_button )
    make_persistent( $piano_position )
    make_persistent( $piano_position_random )
    make_persistent( $piano_volume )

    make_persistent( $ethereal_toggle_button )
    make_persistent( $ethereal_reverse_button )
    make_persistent( $ethereal_position )
    make_persistent( $ethereal_position_random )
    make_persistent( $ethereal_volume )

    make_persistent( $sinepluck_toggle_button )
    make_persistent( $sinepluck_reverse_button )
    make_persistent( $sinepluck_position )
    make_persistent( $sinepluck_position_random )
    make_persistent( $sinepluck_volume )

    make_persistent( $waterdrop_toggle_button )
    make_persistent( $waterdrop_reverse_button )
    make_persistent( $waterdrop_position )
    make_persistent( $waterdrop_position_random )
    make_persistent( $waterdrop_volume )

    make_persistent( $lfo_freq )
    make_persistent( $lfo_depth )
    make_persistent( $lfo_fade_in )

    make_persistent( $reverb_amount )
    make_persistent( $reverb_pre_delay )
    make_persistent( $reverb_time )
    make_persistent( $reverb_size )
    make_persistent( $reverb_stereo )
    make_persistent( $reverb_low_shelf )
    make_persistent( $reverb_high_cut )
    make_persistent( $reverb_bypass_button )

    make_persistent( $filter_lowcut )
    make_persistent( $filter_lowcut_resonance )
    make_persistent( $filter_highcut )
    make_persistent( $filter_highcut_resonance )
    make_persistent( $filter_bypass_button )

    make_persistent( $psyche_delay_amount )
    make_persistent( $psyche_delay_time )
    make_persistent( $psyche_delay_feedback )
    make_persistent( $psyche_delay_lr_offset )
    make_persistent( $psyche_delay_cross_fb )
    make_persistent( $psyche_delay_pitch )
    make_persistent( $psyche_delay_detune )
    make_persistent( $psyche_delay_bypass_button )

    make_persistent( $replika_delay_amount )
    make_persistent( $replika_delay_time )
    make_persistent( $replika_delay_feedback )
    make_persistent( $replika_delay_depth )
    make_persistent( $replika_delay_rate )
    make_persistent( $replika_delay_saturation )
    make_persistent( $replika_delay_filter )
    make_persistent( $replika_delay_bypass_button )


    {Automation ID/Names}
    set_control_par(get_ui_id($grainAmount), $CONTROL_PAR_AUTOMATION_ID, 0) 
    set_control_par_str(get_ui_id($grainAmount), $CONTROL_PAR_AUTOMATION_NAME, "Grain Amount")

    set_control_par(get_ui_id($grainDuration), $CONTROL_PAR_AUTOMATION_ID, 1) 
    set_control_par_str(get_ui_id($grainDuration), $CONTROL_PAR_AUTOMATION_NAME, "Grain Duration")

    set_control_par(get_ui_id($width_knob), $CONTROL_PAR_AUTOMATION_ID, 2)
    set_control_par_str(get_ui_id($width_knob), $CONTROL_PAR_AUTOMATION_NAME, "Width") 

    set_control_par(get_ui_id($amp_env_attack), $CONTROL_PAR_AUTOMATION_ID, 3)
    set_control_par_str(get_ui_id($amp_env_attack), $CONTROL_PAR_AUTOMATION_NAME, "Attack") 

    set_control_par(get_ui_id($amp_env_decay), $CONTROL_PAR_AUTOMATION_ID, 4)
    set_control_par_str(get_ui_id($amp_env_decay), $CONTROL_PAR_AUTOMATION_NAME, "Decay")

    set_control_par(get_ui_id($lfo_freq), $CONTROL_PAR_AUTOMATION_ID, 45)
    set_control_par_str(get_ui_id($lfo_freq), $CONTROL_PAR_AUTOMATION_NAME, "LFO Frequency")

    set_control_par(get_ui_id($lfo_depth), $CONTROL_PAR_AUTOMATION_ID, 46)
    set_control_par_str(get_ui_id($lfo_depth), $CONTROL_PAR_AUTOMATION_NAME, "LFO Depth")

    set_control_par(get_ui_id($lfo_fade_in), $CONTROL_PAR_AUTOMATION_ID, 47)
    set_control_par_str(get_ui_id($lfo_fade_in), $CONTROL_PAR_AUTOMATION_NAME, "LFO Fade In")

    set_control_par(get_ui_id($reverb_amount), $CONTROL_PAR_AUTOMATION_ID, 5)
    set_control_par_str(get_ui_id($reverb_amount), $CONTROL_PAR_AUTOMATION_NAME, "Reverb Amount") 

    set_control_par(get_ui_id($reverb_pre_delay), $CONTROL_PAR_AUTOMATION_ID, 6) 
    set_control_par_str(get_ui_id($reverb_pre_delay), $CONTROL_PAR_AUTOMATION_NAME, "Reverb Pre-Delay") 

    set_control_par(get_ui_id($reverb_time), $CONTROL_PAR_AUTOMATION_ID, 7) 
    set_control_par_str(get_ui_id($reverb_time), $CONTROL_PAR_AUTOMATION_NAME, "Reverb Time") 

    set_control_par(get_ui_id($reverb_size), $CONTROL_PAR_AUTOMATION_ID, 8) 
    set_control_par_str(get_ui_id($reverb_size), $CONTROL_PAR_AUTOMATION_NAME, "Reverb Size") 

    set_control_par(get_ui_id($reverb_stereo), $CONTROL_PAR_AUTOMATION_ID, 9) 
    set_control_par_str(get_ui_id($reverb_stereo), $CONTROL_PAR_AUTOMATION_NAME, "Reverb Stereo Width") 

    set_control_par(get_ui_id($reverb_low_shelf), $CONTROL_PAR_AUTOMATION_ID, 10) 
    set_control_par_str(get_ui_id($reverb_low_shelf), $CONTROL_PAR_AUTOMATION_NAME, "Reverb Low Shelf") 

    set_control_par(get_ui_id($reverb_high_cut), $CONTROL_PAR_AUTOMATION_ID, 11)
    set_control_par_str(get_ui_id($reverb_high_cut), $CONTROL_PAR_AUTOMATION_NAME, "Reverb High Cut") 

    set_control_par(get_ui_id($filter_lowcut), $CONTROL_PAR_AUTOMATION_ID, 12) 
    set_control_par_str(get_ui_id($filter_lowcut), $CONTROL_PAR_AUTOMATION_NAME, "Filter Low Cut")

    set_control_par(get_ui_id($filter_lowcut_resonance), $CONTROL_PAR_AUTOMATION_ID, 13) 
    set_control_par_str(get_ui_id($filter_lowcut_resonance), $CONTROL_PAR_AUTOMATION_NAME, "Filter Low Cut Resonance")

    set_control_par(get_ui_id($filter_highcut), $CONTROL_PAR_AUTOMATION_ID, 14) 
    set_control_par_str(get_ui_id($filter_highcut), $CONTROL_PAR_AUTOMATION_NAME, "Filter High Cut") 

    set_control_par(get_ui_id($filter_highcut_resonance), $CONTROL_PAR_AUTOMATION_ID, 15) 
    set_control_par_str(get_ui_id($filter_highcut_resonance), $CONTROL_PAR_AUTOMATION_NAME, "Filter High Cut Resonance") 

    set_control_par(get_ui_id($psyche_delay_amount), $CONTROL_PAR_AUTOMATION_ID, 16) 
    set_control_par_str(get_ui_id($psyche_delay_amount), $CONTROL_PAR_AUTOMATION_NAME, "Psyche Delay Amount") 

    set_control_par(get_ui_id($psyche_delay_time), $CONTROL_PAR_AUTOMATION_ID, 17) 
    set_control_par_str(get_ui_id($psyche_delay_time), $CONTROL_PAR_AUTOMATION_NAME, "Psyche Delay Time") 

    set_control_par(get_ui_id($psyche_delay_feedback), $CONTROL_PAR_AUTOMATION_ID, 18) 
    set_control_par_str(get_ui_id($psyche_delay_feedback), $CONTROL_PAR_AUTOMATION_NAME, "Psyche Delay Feedback") 

    set_control_par(get_ui_id($psyche_delay_lr_offset), $CONTROL_PAR_AUTOMATION_ID, 19)
    set_control_par_str(get_ui_id($psyche_delay_lr_offset), $CONTROL_PAR_AUTOMATION_NAME, "Psyche Delay Left/Right Offset")

    set_control_par(get_ui_id($psyche_delay_cross_fb), $CONTROL_PAR_AUTOMATION_ID, 20)
    set_control_par_str(get_ui_id($psyche_delay_cross_fb), $CONTROL_PAR_AUTOMATION_NAME, "Psyche Delay Cross Feedback")

    set_control_par(get_ui_id($psyche_delay_pitch), $CONTROL_PAR_AUTOMATION_ID, 21)
    set_control_par_str(get_ui_id($psyche_delay_pitch), $CONTROL_PAR_AUTOMATION_NAME, "Psyche Delay Pitch")

    set_control_par(get_ui_id($psyche_delay_detune), $CONTROL_PAR_AUTOMATION_ID, 22)
    set_control_par_str(get_ui_id($psyche_delay_detune), $CONTROL_PAR_AUTOMATION_NAME, "Psyche Delay Detune")

    set_control_par(get_ui_id($replika_delay_amount), $CONTROL_PAR_AUTOMATION_ID, 23)
    set_control_par_str(get_ui_id($replika_delay_amount), $CONTROL_PAR_AUTOMATION_NAME, "Replika Delay Amount")

    set_control_par(get_ui_id($replika_delay_time), $CONTROL_PAR_AUTOMATION_ID, 24)
    set_control_par_str(get_ui_id($replika_delay_time), $CONTROL_PAR_AUTOMATION_NAME, "Replika Delay Time")

    set_control_par(get_ui_id($replika_delay_feedback), $CONTROL_PAR_AUTOMATION_ID, 25)
    set_control_par_str(get_ui_id($replika_delay_feedback), $CONTROL_PAR_AUTOMATION_NAME, "Replika Delay Feedback")

    set_control_par(get_ui_id($replika_delay_depth), $CONTROL_PAR_AUTOMATION_ID, 26)
    set_control_par_str(get_ui_id($replika_delay_depth), $CONTROL_PAR_AUTOMATION_NAME, "Replika Delay Depth")

    set_control_par(get_ui_id($replika_delay_rate), $CONTROL_PAR_AUTOMATION_ID, 27)
    set_control_par_str(get_ui_id($replika_delay_rate), $CONTROL_PAR_AUTOMATION_NAME, "Replika Delay Rate")

    set_control_par(get_ui_id($replika_delay_saturation), $CONTROL_PAR_AUTOMATION_ID, 28)
    set_control_par_str(get_ui_id($replika_delay_saturation), $CONTROL_PAR_AUTOMATION_NAME, "Replika Delay Saturation")

    set_control_par(get_ui_id($replika_delay_filter), $CONTROL_PAR_AUTOMATION_ID, 29)
    set_control_par_str(get_ui_id($replika_delay_filter), $CONTROL_PAR_AUTOMATION_NAME, "Replika Delay Filter")

    set_control_par(get_ui_id($kalimba_position), $CONTROL_PAR_AUTOMATION_ID, 30)
    set_control_par_str(get_ui_id($kalimba_position), $CONTROL_PAR_AUTOMATION_NAME, "Kalimba Position")

    set_control_par(get_ui_id($kalimba_position_random), $CONTROL_PAR_AUTOMATION_ID, 31)
    set_control_par_str(get_ui_id($kalimba_position_random), $CONTROL_PAR_AUTOMATION_NAME, "Kalimba Position Randomness")

    set_control_par(get_ui_id($kalimba_volume), $CONTROL_PAR_AUTOMATION_ID, 32)
    set_control_par_str(get_ui_id($kalimba_volume), $CONTROL_PAR_AUTOMATION_NAME, "Kalimba Volume")

    set_control_par(get_ui_id($rain_stick_position), $CONTROL_PAR_AUTOMATION_ID, 33)
    set_control_par_str(get_ui_id($rain_stick_position), $CONTROL_PAR_AUTOMATION_NAME, "Rain Stick Position")

    set_control_par(get_ui_id($rain_stick_position_random), $CONTROL_PAR_AUTOMATION_ID, 34)
    set_control_par_str(get_ui_id($rain_stick_position_random), $CONTROL_PAR_AUTOMATION_NAME, "Rain Stick Position Randomness")

    set_control_par(get_ui_id($rain_stick_volume), $CONTROL_PAR_AUTOMATION_ID, 35)
    set_control_par_str(get_ui_id($rain_stick_volume), $CONTROL_PAR_AUTOMATION_NAME, "Rain Stick Volume")

    set_control_par(get_ui_id($native_flute_position), $CONTROL_PAR_AUTOMATION_ID, 36)
    set_control_par_str(get_ui_id($native_flute_position), $CONTROL_PAR_AUTOMATION_NAME, "Native Flute Position")

    set_control_par(get_ui_id($native_flute_position_random), $CONTROL_PAR_AUTOMATION_ID, 37)
    set_control_par_str(get_ui_id($native_flute_position_random), $CONTROL_PAR_AUTOMATION_NAME, "Native Flute Position Randomness")

    set_control_par(get_ui_id($native_flute_volume), $CONTROL_PAR_AUTOMATION_ID, 38)
    set_control_par_str(get_ui_id($native_flute_volume), $CONTROL_PAR_AUTOMATION_NAME, "Native Flute Volume")

    set_control_par(get_ui_id($guitar_position), $CONTROL_PAR_AUTOMATION_ID, 39)
    set_control_par_str(get_ui_id($guitar_position), $CONTROL_PAR_AUTOMATION_NAME, "Guitar Position")

    set_control_par(get_ui_id($guitar_position_random), $CONTROL_PAR_AUTOMATION_ID, 40)
    set_control_par_str(get_ui_id($guitar_position_random), $CONTROL_PAR_AUTOMATION_NAME, "Guitar Position Randomness")

    set_control_par(get_ui_id($guitar_volume), $CONTROL_PAR_AUTOMATION_ID, 41)
    set_control_par_str(get_ui_id($guitar_volume), $CONTROL_PAR_AUTOMATION_NAME, "Guitar Volume")

    set_control_par(get_ui_id($sawpluck_position), $CONTROL_PAR_AUTOMATION_ID, 42)
    set_control_par_str(get_ui_id($sawpluck_position), $CONTROL_PAR_AUTOMATION_NAME, "Saw Pluck Position")

    set_control_par(get_ui_id($sawpluck_position_random), $CONTROL_PAR_AUTOMATION_ID, 43)
    set_control_par_str(get_ui_id($sawpluck_position_random), $CONTROL_PAR_AUTOMATION_NAME, "Saw Pluck Position Randomness")

    set_control_par(get_ui_id($sawpluck_volume), $CONTROL_PAR_AUTOMATION_ID, 44)
    set_control_par_str(get_ui_id($sawpluck_volume), $CONTROL_PAR_AUTOMATION_NAME, "Saw Pluck Volume")

    set_control_par(get_ui_id($vocal_position), $CONTROL_PAR_AUTOMATION_ID, 48)
    set_control_par_str(get_ui_id($vocal_position), $CONTROL_PAR_AUTOMATION_NAME, "Vocal Position")

    set_control_par(get_ui_id($vocal_position_random), $CONTROL_PAR_AUTOMATION_ID, 49)
    set_control_par_str(get_ui_id($vocal_position_random), $CONTROL_PAR_AUTOMATION_NAME, "Vocal Position Randomness")

    set_control_par(get_ui_id($vocal_volume), $CONTROL_PAR_AUTOMATION_ID, 50)
    set_control_par_str(get_ui_id($vocal_volume), $CONTROL_PAR_AUTOMATION_NAME, "Vocal Volume")

    set_control_par(get_ui_id($piano_position), $CONTROL_PAR_AUTOMATION_ID, 51)
    set_control_par_str(get_ui_id($piano_position), $CONTROL_PAR_AUTOMATION_NAME, "Piano Position")

    set_control_par(get_ui_id($piano_position_random), $CONTROL_PAR_AUTOMATION_ID, 52)
    set_control_par_str(get_ui_id($piano_position_random), $CONTROL_PAR_AUTOMATION_NAME, "Piano Position Randomness")

    set_control_par(get_ui_id($piano_volume), $CONTROL_PAR_AUTOMATION_ID, 53)
    set_control_par_str(get_ui_id($piano_volume), $CONTROL_PAR_AUTOMATION_NAME, "Piano Volume")

    set_control_par(get_ui_id($ethereal_position), $CONTROL_PAR_AUTOMATION_ID, 54)
    set_control_par_str(get_ui_id($ethereal_position), $CONTROL_PAR_AUTOMATION_NAME, "Ethereal Position")

    set_control_par(get_ui_id($ethereal_position_random), $CONTROL_PAR_AUTOMATION_ID, 55)
    set_control_par_str(get_ui_id($ethereal_position_random), $CONTROL_PAR_AUTOMATION_NAME, "Ethereal Position Randomness")

    set_control_par(get_ui_id($ethereal_volume), $CONTROL_PAR_AUTOMATION_ID, 56)
    set_control_par_str(get_ui_id($ethereal_volume), $CONTROL_PAR_AUTOMATION_NAME, "Ethereal Volume")

    set_control_par(get_ui_id($sinepluck_position), $CONTROL_PAR_AUTOMATION_ID, 57)
    set_control_par_str(get_ui_id($sinepluck_position), $CONTROL_PAR_AUTOMATION_NAME, "Sine Pluck Position")

    set_control_par(get_ui_id($sinepluck_position_random), $CONTROL_PAR_AUTOMATION_ID, 58)
    set_control_par_str(get_ui_id($sinepluck_position_random), $CONTROL_PAR_AUTOMATION_NAME, "Sine Pluck Position Randomness")

    set_control_par(get_ui_id($sinepluck_volume), $CONTROL_PAR_AUTOMATION_ID, 59)
    set_control_par_str(get_ui_id($sinepluck_volume), $CONTROL_PAR_AUTOMATION_NAME, "Sine Pluck Volume")

    set_control_par(get_ui_id($waterdrop_position), $CONTROL_PAR_AUTOMATION_ID, 60)
    set_control_par_str(get_ui_id($waterdrop_position), $CONTROL_PAR_AUTOMATION_NAME, "Water Drop Position")

    set_control_par(get_ui_id($waterdrop_position_random), $CONTROL_PAR_AUTOMATION_ID, 61)
    set_control_par_str(get_ui_id($waterdrop_position_random), $CONTROL_PAR_AUTOMATION_NAME, "Water Drop Position Randomness")

    set_control_par(get_ui_id($waterdrop_volume), $CONTROL_PAR_AUTOMATION_ID, 62)
    set_control_par_str(get_ui_id($waterdrop_volume), $CONTROL_PAR_AUTOMATION_NAME, "Water Drop Volume")
end on



on persistence_changed
    set_control_par_str(get_ui_id( $grainAmount_label ), $CONTROL_PAR_TEXT, get_control_par(get_ui_id( $grainAmount ), $CONTROL_PAR_VALUE) & " GRAINS")
    set_control_par_str( get_ui_id( $grainDuration_label ), $CONTROL_PAR_TEXT, get_engine_par_disp( $ENGINE_PAR_HOLD, 0, 0, -1 ) & " ms" )

    set_control_par_str( get_ui_id( $width_label ), $CONTROL_PAR_TEXT, "WIDTH" )

    $timebetweenGrains := 1000000 / get_control_par(get_ui_id($grainAmount), $CONTROL_PAR_VALUE) {update time between grains}


    {Instrument Settings}
    %instrument_position[0] := $kalimba_position
    %instrument_position[1] := $rain_stick_position
    %instrument_position[2] := $native_flute_position
    %instrument_position[3] := $guitar_position
    %instrument_position[4] := $sawpluck_position
    %instrument_position[5] := $vocal_position
    %instrument_position[6] := $piano_position
    %instrument_position[7] := $ethereal_position
    %instrument_position[8] := $sinepluck_position
    %instrument_position[9] := $waterdrop_position

    ?instrument_position_randomness[0] := real($kalimba_position_random ) / 1000000.0
    ?instrument_position_randomness[1] := real($rain_stick_position_random ) / 1000000.0
    ?instrument_position_randomness[2] := real($native_flute_position_random ) / 1000000.0
    ?instrument_position_randomness[3] := real($guitar_position_random ) / 1000000.0
    ?instrument_position_randomness[4] := real($sawpluck_position_random ) / 1000000.0
    ?instrument_position_randomness[5] := real($vocal_position_random ) / 1000000.0
    ?instrument_position_randomness[6] := real($piano_position_random ) / 1000000.0
    ?instrument_position_randomness[7] := real($ethereal_position_random ) / 1000000.0
    ?instrument_position_randomness[8] := real($sinepluck_position_random ) / 1000000.0
    ?instrument_position_randomness[9] := real($waterdrop_position_random ) / 1000000.0

    set_engine_par($ENGINE_PAR_VOLUME, $kalimba_volume, 0, 0, -1) {Set volume for Kalimba}
    set_engine_par($ENGINE_PAR_VOLUME, $kalimba_volume, 1, 0, -1) {Set volume for Kalimba}

    set_engine_par($ENGINE_PAR_VOLUME, $rain_stick_volume, 2, 0, -1) {Set volume for Rain Stick}
    set_engine_par($ENGINE_PAR_VOLUME, $rain_stick_volume, 3, 0, -1) {Set volume for Rain Stick}

    set_engine_par($ENGINE_PAR_VOLUME, $native_flute_volume, 4, 0, -1) {Set volume for Native Flute}
    set_engine_par($ENGINE_PAR_VOLUME, $native_flute_volume, 5, 0, -1) {Set volume for Native Flute}

    set_engine_par($ENGINE_PAR_VOLUME, $guitar_volume, 6, 0, -1) {Set volume for Guitar}
    set_engine_par($ENGINE_PAR_VOLUME, $guitar_volume, 7, 0, -1) {Set volume for Guitar}

    set_engine_par($ENGINE_PAR_VOLUME, $sawpluck_volume, 8, 0, -1) {Set volume for Saw Pluck}
    set_engine_par($ENGINE_PAR_VOLUME, $sawpluck_volume, 9, 0, -1) {Set volume for Saw Pluck}

    set_engine_par($ENGINE_PAR_VOLUME, $vocal_volume, 10, 0, -1) {Set volume for Vocal}
    set_engine_par($ENGINE_PAR_VOLUME, $vocal_volume, 11, 0, -1) {Set volume for Vocal}

    set_engine_par($ENGINE_PAR_VOLUME, $piano_volume, 12, 0, -1) {Set volume for Piano}
    set_engine_par($ENGINE_PAR_VOLUME, $piano_volume, 13, 0, -1) {Set volume for Piano}

    set_engine_par($ENGINE_PAR_VOLUME, $ethereal_volume, 14, 0, -1) {Set volume for Ethereal}
    set_engine_par($ENGINE_PAR_VOLUME, $ethereal_volume, 15, 0, -1) {Set volume for Ethereal}

    set_engine_par($ENGINE_PAR_VOLUME, $sinepluck_volume, 16, 0, -1) {Set volume for Sine Pluck}
    set_engine_par($ENGINE_PAR_VOLUME, $sinepluck_volume, 17, 0, -1) {Set volume for Sine Pluck}

    set_engine_par($ENGINE_PAR_VOLUME, $waterdrop_volume, 18, 0, -1) {Set volume for Water Drop}
    set_engine_par($ENGINE_PAR_VOLUME, $waterdrop_volume, 19, 0, -1) {Set volume for Water Drop}

    {Activation of Instruments}
    if($kalimba_toggle_button = 1) {Activate Kalimba if the toggle button is active}
        %instrument_active[0] := 1
    else
        %instrument_active[0] := 0
    end if

    if($kalimba_reverse_button = 1) {Activate Kalimba Reverse if the toggle button is active}
        %instrument_reverse[0] := 1
    else
        %instrument_reverse[0] := 0
    end if

    if($rain_stick_toggle_button = 1) {Activate Rain Effect if the toggle button is active}
        %instrument_active[1] := 1
    else
        %instrument_active[1] := 0
    end if

    if($rain_stick_reverse_button = 1) {Activate Rain Effect Reverse if the toggle button is active}
        %instrument_reverse[1] := 1
    else
        %instrument_reverse[1] := 0
    end if

    if($native_flute_toggle_button = 1) {Activate Native Flute if the toggle button is active}
        %instrument_active[2] := 1
    else
        %instrument_active[2] := 0
    end if

    if($native_flute_reverse_button = 1) {Activate Native Flute Reverse if the toggle button is active}
        %instrument_reverse[2] := 1
    else
        %instrument_reverse[2] := 0
    end if

    if($guitar_toggle_button = 1) {Activate Guitar if the toggle button is active}
        %instrument_active[3] := 1
    else
        %instrument_active[3] := 0
    end if

    if($guitar_reverse_button = 1) {Activate Guitar Reverse if the toggle button is active}
        %instrument_reverse[3] := 1
    else
        %instrument_reverse[3] := 0
    end if

    if($sawpluck_toggle_button = 1) {Activate Saw Pluck if the toggle button is active}
        %instrument_active[4] := 1
    else
        %instrument_active[4] := 0
    end if

    if($sawpluck_reverse_button = 1) {Activate Saw Pluck Reverse if the toggle button is active}
        %instrument_reverse[4] := 1
    else
        %instrument_reverse[4] := 0
    end if

    if($vocal_toggle_button = 1) {Activate Vocal if the toggle button is active}
        %instrument_active[5] := 1
    else
        %instrument_active[5] := 0
    end if

    if($vocal_reverse_button = 1) {Activate Vocal Reverse if the toggle button is active}
        %instrument_reverse[5] := 1
    else
        %instrument_reverse[5] := 0
    end if

    if($piano_toggle_button = 1) {Activate Piano if the toggle button is active}
        %instrument_active[6] := 1
    else
        %instrument_active[6] := 0
    end if

    if($piano_reverse_button = 1) {Activate Piano Reverse if the toggle button is active}
        %instrument_reverse[6] := 1
    else
        %instrument_reverse[6] := 0
    end if

    if($ethereal_toggle_button = 1) {Activate Ethereal if the toggle button is active}
        %instrument_active[7] := 1
    else
        %instrument_active[7] := 0
    end if

    if($ethereal_reverse_button = 1) {Activate Ethereal Reverse if the toggle button is active}
        %instrument_reverse[7] := 1
    else
        %instrument_reverse[7] := 0
    end if

    if($sinepluck_toggle_button = 1) {Activate Sine Pluck if the toggle button is active}
        %instrument_active[8] := 1
    else
        %instrument_active[8] := 0
    end if

    if($sinepluck_reverse_button = 1) {Activate Sine Pluck Reverse if the toggle button is active}
        %instrument_reverse[8] := 1
    else
        %instrument_reverse[8] := 0
    end if

    if($waterdrop_toggle_button = 1) {Activate Water Drop if the toggle button is active}
        %instrument_active[9] := 1
    else
        %instrument_active[9] := 0
    end if

    if($waterdrop_reverse_button = 1) {Activate Water Drop Reverse if the toggle button is active}
        %instrument_reverse[9] := 1
    else
        %instrument_reverse[9] := 0
    end if

    {Automation Labels}
    set_control_par_str( get_ui_id( $grainAmount ), $CONTROL_PAR_LABEL, get_control_par(get_ui_id($grainAmount), $CONTROL_PAR_VALUE) & " GRAINS" )
    set_control_par_str( get_ui_id( $grainDuration ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_HOLD, 0, 0, -1 ) & " ms" )
    set_control_par_str( get_ui_id( $amp_env_attack ), $CONTROL_PAR_LABEL, get_engine_par_disp($ENGINE_PAR_ATTACK, 0, 0, -1) & " ms" )
    set_control_par_str( get_ui_id( $amp_env_decay ), $CONTROL_PAR_LABEL, get_engine_par_disp($ENGINE_PAR_DECAY, 0, 0, -1) & " ms" )
    set_control_par_str( get_ui_id( $width_knob ), $CONTROL_PAR_LABEL, $width_knob/10 & "%" )
    
    set_control_par_str(get_ui_id($lfo_freq), $CONTROL_PAR_LABEL, get_engine_par_disp($ENGINE_PAR_INTMOD_FREQUENCY, 0, get_mod_idx( 0,"LFO"), -1) & " Hz")
    set_control_par_str(get_ui_id($lfo_depth), $CONTROL_PAR_LABEL, get_engine_par_disp($ENGINE_PAR_INTMOD_INTENSITY, 0, get_mod_idx( 0,"LFO"), -1) & " %")
    set_control_par_str(get_ui_id($lfo_fade_in), $CONTROL_PAR_LABEL, get_engine_par_disp($ENGINE_PAR_LFO_DELAY, 0, get_mod_idx( 0,"LFO"), -1) & " ms")

    set_control_par_str( get_ui_id( $reverb_amount ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_SEND_EFFECT_OUTPUT_GAIN, -1, 0, $NI_MAIN_BUS ) & " dB" )
    set_control_par_str( get_ui_id( $reverb_pre_delay ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_RV2_PREDELAY, -1, 0, $NI_MAIN_BUS ) & " ms" )
    set_control_par_str( get_ui_id( $reverb_time ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_RV2_TIME, -1, 0, $NI_MAIN_BUS ) & " ms" )
    set_control_par_str( get_ui_id( $reverb_size ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_RV2_SIZE, -1, 0, $NI_MAIN_BUS ) & " %" )
    set_control_par_str( get_ui_id( $reverb_stereo ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_RV2_STEREO, -1, 0, $NI_MAIN_BUS ) & " %" )
    set_control_par_str( get_ui_id( $reverb_low_shelf ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_RV2_LOWSHELF, -1, 0, $NI_MAIN_BUS ) & " dB" )
    set_control_par_str( get_ui_id( $reverb_high_cut ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_RV2_HIGHCUT, -1, 0, $NI_MAIN_BUS ) & " Hz" )

    set_control_par_str( get_ui_id( $filter_lowcut ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_CUTOFF, -1, 1, $NI_MAIN_BUS ) & " Hz" )
    set_control_par_str( get_ui_id( $filter_lowcut_resonance ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_RESONANCE, -1, 1, $NI_MAIN_BUS ) & " %" )
    set_control_par_str( get_ui_id( $filter_highcut ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_CUTOFF, -1, 2, $NI_MAIN_BUS ) & " Hz" )
    set_control_par_str( get_ui_id( $filter_highcut_resonance ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_RESONANCE, -1, 2, $NI_MAIN_BUS ) & " %" )

    set_control_par_str( get_ui_id( $psyche_delay_amount ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_SEND_EFFECT_OUTPUT_GAIN, -1, 0, $NI_SEND_BUS ) & " dB" )
    set_control_par_str( get_ui_id( $psyche_delay_time ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_PSYDL_TIME, -1, 0, $NI_SEND_BUS ) & " ms" )
    set_control_par_str( get_ui_id( $psyche_delay_feedback ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_PSYDL_FEEDBACK, -1, 0, $NI_SEND_BUS ) & " %" )
    set_control_par_str( get_ui_id( $psyche_delay_lr_offset ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_PSYDL_LR_OFFSET, -1, 0, $NI_SEND_BUS ) & " %" )
    set_control_par_str( get_ui_id( $psyche_delay_cross_fb ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_PSYDL_CROSS_FEEDBACK, -1, 0, $NI_SEND_BUS ) & " %" )
    set_control_par_str( get_ui_id( $psyche_delay_pitch ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_PSYDL_PITCH, -1, 0, $NI_SEND_BUS ) & " st" )
    set_control_par_str( get_ui_id( $psyche_delay_detune ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_PSYDL_DETUNE, -1, 0, $NI_SEND_BUS ) & " cts" )

    set_control_par_str( get_ui_id( $replika_delay_amount ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_SEND_EFFECT_OUTPUT_GAIN, -1, 1, $NI_SEND_BUS ) & " dB" )
    set_control_par_str( get_ui_id( $replika_delay_time ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_RDL_TIME, -1, 1, $NI_SEND_BUS ) & " ms" )
    set_control_par_str( get_ui_id( $replika_delay_feedback ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_RDL_FEEDBACK, -1, 1, $NI_SEND_BUS ) & " %" )
    set_control_par_str( get_ui_id( $replika_delay_depth ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_RDL_DEPTH, -1, 1, $NI_SEND_BUS ) & " %" )
    set_control_par_str( get_ui_id( $replika_delay_rate ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_RDL_RATE, -1, 1, $NI_SEND_BUS ) & " Hz" )
    set_control_par_str( get_ui_id( $replika_delay_saturation ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_RDL_SATURATION, -1, 1, $NI_SEND_BUS ) & " %" )
    set_control_par_str( get_ui_id( $replika_delay_filter ), $CONTROL_PAR_LABEL, "HC " & ((1000000 - $replika_delay_filter * 2) / 10000) & " %" )
    set_control_par_str( get_ui_id( $replika_delay_filter ), $CONTROL_PAR_LABEL, "LC " & ($replika_delay_filter - 500000) * 2 / 10000 & " %" )
    set_control_par_str( get_ui_id( $replika_delay_filter ), $CONTROL_PAR_LABEL, "Default" )

    set_control_par_str( get_ui_id( $kalimba_position ), $CONTROL_PAR_LABEL, $kalimba_position_random / 10000 & "%" )
    set_control_par_str( get_ui_id( $kalimba_volume ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_VOLUME, 0, 0, -1 ) & " dB" )

    set_control_par_str( get_ui_id( $rain_stick_position ), $CONTROL_PAR_LABEL, $rain_stick_position_random / 10000 & "%" )
    set_control_par_str( get_ui_id( $rain_stick_volume ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_VOLUME, 2, 0, -1 ) & " dB" )
    
    set_control_par_str( get_ui_id( $native_flute_position ), $CONTROL_PAR_LABEL, $native_flute_position_random / 10000 & "%" )
    set_control_par_str( get_ui_id( $native_flute_volume ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_VOLUME, 4, 0, -1 ) & " dB" )
    
    set_control_par_str( get_ui_id( $guitar_position ), $CONTROL_PAR_LABEL, $guitar_position_random / 10000 & "%" )
    set_control_par_str( get_ui_id( $guitar_volume ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_VOLUME, 6, 0, -1 ) & " dB" )

    set_control_par_str( get_ui_id( $vocal_position ), $CONTROL_PAR_LABEL, $vocal_position_random / 10000 & "%" )
    set_control_par_str( get_ui_id( $vocal_volume ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_VOLUME, 10, 0, -1 ) & " dB" )
    
    set_control_par_str( get_ui_id( $sawpluck_position ), $CONTROL_PAR_LABEL, $sawpluck_position_random / 10000 & "%" )
    set_control_par_str( get_ui_id( $sawpluck_volume ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_VOLUME, 8, 0, -1 ) & " dB" )

    set_control_par_str( get_ui_id( $guitar_position ), $CONTROL_PAR_LABEL, $guitar_position_random / 10000 & "%" )
    set_control_par_str( get_ui_id( $guitar_volume ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_VOLUME, 6, 0, -1 ) & " dB" )

    set_control_par_str( get_ui_id( $piano_position ), $CONTROL_PAR_LABEL, $piano_position_random / 10000 & "%" )
    set_control_par_str( get_ui_id( $piano_volume ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_VOLUME, 12, 0, -1 ) & " dB" )

    set_control_par_str( get_ui_id( $ethereal_position ), $CONTROL_PAR_LABEL, $ethereal_position_random / 10000 & "%" )
    set_control_par_str( get_ui_id( $ethereal_volume ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_VOLUME, 14, 0, -1 ) & " dB" )

    set_control_par_str( get_ui_id( $sinepluck_position ), $CONTROL_PAR_LABEL, $sinepluck_position_random / 10000 & "%" )
    set_control_par_str( get_ui_id( $sinepluck_volume ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_VOLUME, 16, 0, -1 ) & " dB" )

    set_control_par_str( get_ui_id( $waterdrop_position ), $CONTROL_PAR_LABEL, $waterdrop_position_random / 10000 & "%" )
    set_control_par_str( get_ui_id( $waterdrop_volume ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_VOLUME, 18, 0, -1 ) & " dB" )
end on




on note
    ignore_event($EVENT_ID)

    %note_active[$EVENT_NOTE] := 1
    %evento_id[$EVENT_NOTE] := $EVENT_ID {Store the event ID for the note}

    while(%evento_id[$EVENT_NOTE] = $EVENT_ID and %note_active[$EVENT_NOTE] = 1)

            {First active/deactive the groups}
            $a := 0
            $b := 0
            while ( $a < $instrument_number )
                $b := $a * 2
                if(%instrument_active[$a] = 1)
                    if (%instrument_reverse[$a] = 0)        {If normal}
                        allow_group( %group[$b])
                        disallow_group( %group[$b + 1] ) 

                        set_engine_par( $ENGINE_PAR_MOD_TARGET_INTENSITY, %instrument_position[$a] + int( real( random( - %instrument_position[$a], 1000000 - %instrument_position[$a] ) ) * ?instrument_position_randomness[$a] ), %group[$b], get_mod_idx( %group[$b], "SAMPLE START" ), -1 )
                    else                                    {If reversed}
                        allow_group( %group[$b + 1])
                        disallow_group( %group[$b] ) 

                        set_engine_par( $ENGINE_PAR_MOD_TARGET_INTENSITY, (1000000) - (%instrument_position[$a] + int( real( random( - %instrument_position[$a], 1000000 - %instrument_position[$a] ) ) * ?instrument_position_randomness[$a] )), %group[$b + 1], get_mod_idx( %group[$b + 1], "SAMPLE START" ), -1 )
                    end if
                else
                    disallow_group( %group[$b] )
                    disallow_group( %group[$b + 1] )
                end if

                inc($a)
            end while

            {Set position (+ random) per isntrumnet}
            
        
            $new_id := play_note($EVENT_NOTE, $EVENT_VELOCITY, $offset, 0)
            change_pan( $new_id, random( - $width_knob, $width_knob), 0 )

            message( "PLAYING " & $EVENT_NOTE & " with ID: " & $EVENT_ID )
            wait($timebetweenGrains)
    end while
end on




on release
    %note_active[$EVENT_NOTE] := 0
    if(%evento_id[$EVENT_NOTE] = $EVENT_ID)
        %evento_id[$EVENT_NOTE] := 0 {Reset the event ID for the note}
    end if
end on



{Granular Settings}
on ui_control( $grainAmount )
    %callback_ids[0] := $NI_CALLBACK_ID
    $timebetweenGrains := 1000000 / get_control_par(get_ui_id($grainAmount), $CONTROL_PAR_VALUE) {update time between grains}
    set_control_par_str( get_ui_id( $grainAmount ), $CONTROL_PAR_LABEL, get_control_par(get_ui_id($grainAmount), $CONTROL_PAR_VALUE) & " GRAINS" )
    set_control_par_str( get_ui_id( $grainAmount_label ), $CONTROL_PAR_TEXT, get_control_par(get_ui_id($grainAmount), $CONTROL_PAR_VALUE) & " GRAINS" )
end on

on ui_control( $grainDuration )
    %callback_ids[1] := $NI_CALLBACK_ID
    $count := 0
    while ( $count < $instrument_number * 2 )
        set_engine_par($ENGINE_PAR_HOLD, $grainDuration, $count, 0, -1)
        inc($count)
    end while
    
    set_control_par_str( get_ui_id( $grainDuration ), $CONTROL_PAR_LABEL, get_engine_par_disp($ENGINE_PAR_HOLD, 0, 0, -1) & " ms" )
    set_control_par_str( get_ui_id( $grainDuration_label ), $CONTROL_PAR_TEXT, get_engine_par_disp($ENGINE_PAR_HOLD, 0, 0, -1) & " ms" )
end on

on ui_control( $amp_env_attack )
    %callback_ids[2] := $NI_CALLBACK_ID

    $count := 0
    while ( $count < $instrument_number * 2 )
        set_engine_par($ENGINE_PAR_ATTACK, $amp_env_attack, $count, 0, -1)
        inc($count)
    end while

    set_control_par_str( get_ui_id( $amp_env_attack ), $CONTROL_PAR_LABEL, get_engine_par_disp($ENGINE_PAR_ATTACK, 0, 0, -1) & " ms" )
    set_control_par_str( get_ui_id( $amp_env_attack_label ), $CONTROL_PAR_TEXT, get_engine_par_disp($ENGINE_PAR_ATTACK, 0, 0, -1) & " ms" )

    wait($ui_wait)
    if(%callback_ids[2] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($amp_env_attack_label), $CONTROL_PAR_TEXT, "Attack")
    end if
end on

on ui_control( $amp_env_decay )
    %callback_ids[3] := $NI_CALLBACK_ID

    $count := 0
    while ( $count < $instrument_number * 2)
        set_engine_par($ENGINE_PAR_DECAY, $amp_env_decay, $count, 0, -1)
        inc($count)
    end while

    set_control_par_str( get_ui_id( $amp_env_decay ), $CONTROL_PAR_LABEL, get_engine_par_disp($ENGINE_PAR_DECAY, 0, 0, -1) & " ms" )
    set_control_par_str( get_ui_id( $amp_env_decay_label ), $CONTROL_PAR_TEXT, get_engine_par_disp($ENGINE_PAR_DECAY, 0, 0, -1) & " ms" )

    wait($ui_wait)
    if(%callback_ids[3] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($amp_env_decay_label), $CONTROL_PAR_TEXT, "Decay")
    end if
end on

on ui_control( $width_knob )
    %callback_ids[4] := $NI_CALLBACK_ID
    
    set_control_par_str( get_ui_id( $width_knob ), $CONTROL_PAR_LABEL, $width_knob/10 & "%" )
    set_control_par_str( get_ui_id( $width_label ), $CONTROL_PAR_TEXT, "  " & $width_knob/10 & "%" )

    wait( $ui_wait )
    if( %callback_ids[4] = $NI_CALLBACK_ID )
    set_control_par_str( get_ui_id( $width_label ), $CONTROL_PAR_TEXT, "WIDTH" )
    end if
end on


{Kalimba Related}
on ui_control( $kalimba_toggle_button )
    %instrument_active[0] := $kalimba_toggle_button
end on

on ui_control( $kalimba_reverse_button )
    if($kalimba_reverse_button = 1)
        %instrument_reverse[0] := 1
    else
        %instrument_reverse[0] := 0
    end if
end on

on ui_control( $kalimba_position )
    %instrument_position[0] := $kalimba_position
end on

on ui_control( $kalimba_position_random )
    %callback_ids[5] := $NI_CALLBACK_ID
    ?instrument_position_randomness[0] := real($kalimba_position_random ) / 1000000.0

    set_control_par_str( get_ui_id( $kalimba_position ), $CONTROL_PAR_LABEL, $kalimba_position_random / 10000 & "%" )
    set_control_par_str( get_ui_id( $kalimba_position_random_label ), $CONTROL_PAR_TEXT, "    " & $kalimba_position_random / 10000 & "%" )

    wait($ui_wait)
    if(%callback_ids[5] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($kalimba_position_random_label), $CONTROL_PAR_TEXT, "RANDOM")
    end if
end on

on ui_control( $kalimba_volume)
    %callback_ids[6] := $NI_CALLBACK_ID
    set_engine_par($ENGINE_PAR_VOLUME, $kalimba_volume, 0, 0, -1) {Set volume for Kalimba}
    set_engine_par($ENGINE_PAR_VOLUME, $kalimba_volume, 1, 0, -1) {Set volume for Kalimba}

    set_control_par_str( get_ui_id( $kalimba_volume ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_VOLUME, 0, 0, -1 ) & " dB" )
    set_control_par_str( get_ui_id( $kalimba_volume_label ), $CONTROL_PAR_TEXT, "  " & get_engine_par_disp( $ENGINE_PAR_VOLUME, 0, 0, -1 ) & " dB" )

    wait($ui_wait)
    if(%callback_ids[6] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($kalimba_volume_label), $CONTROL_PAR_TEXT, "VOLUME")
    end if
end on

{Rain Stick Related}
on ui_control( $rain_stick_toggle_button )
    %instrument_active[1] := $rain_stick_toggle_button
end on

on ui_control( $rain_stick_reverse_button )
    if($rain_stick_reverse_button = 1)
        %instrument_reverse[1] := 1
    else
        %instrument_reverse[1] := 0
    end if
end on

on ui_control( $rain_stick_position )
    %instrument_position[1] := $rain_stick_position
end on

on ui_control( $rain_stick_position_random )
    %callback_ids[7] := $NI_CALLBACK_ID
    ?instrument_position_randomness[1] := real($rain_stick_position_random ) / 1000000.0

    set_control_par_str( get_ui_id( $rain_stick_position ), $CONTROL_PAR_LABEL, $rain_stick_position_random / 10000 & "%" )
    set_control_par_str( get_ui_id( $rain_stick_position_random_label ), $CONTROL_PAR_TEXT, "    " & $rain_stick_position_random / 10000 & "%" )

    wait($ui_wait)
    if(%callback_ids[7] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($rain_stick_position_random_label), $CONTROL_PAR_TEXT, "RANDOM")
    end if
end on

on ui_control( $rain_stick_volume )
    %callback_ids[8] := $NI_CALLBACK_ID
    set_engine_par($ENGINE_PAR_VOLUME, $rain_stick_volume, 2, 0, -1) {Set volume for Rain Stick}
    set_engine_par($ENGINE_PAR_VOLUME, $rain_stick_volume, 3, 0, -1) {Set volume for Rain Stick Reversed}

    set_control_par_str( get_ui_id( $rain_stick_volume ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_VOLUME, 2, 0, -1 ) & " dB" )
    set_control_par_str( get_ui_id( $rain_stick_volume_label ), $CONTROL_PAR_TEXT, "  " & get_engine_par_disp( $ENGINE_PAR_VOLUME, 2, 0, -1 ) & " dB" )

    wait($ui_wait)
    if(%callback_ids[8] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($rain_stick_volume_label), $CONTROL_PAR_TEXT, "VOLUME")
    end if
end on

{Native Flute Related}
on ui_control( $native_flute_toggle_button )
    %instrument_active[2] := $native_flute_toggle_button
end on

on ui_control( $native_flute_reverse_button )
    if($native_flute_reverse_button = 1)
        %instrument_reverse[2] := 1
    else
        %instrument_reverse[2] := 0
    end if
end on

on ui_control( $native_flute_position )
    %instrument_position[2] := $native_flute_position
end on

on ui_control( $native_flute_position_random )
    %callback_ids[37] := $NI_CALLBACK_ID
    ?instrument_position_randomness[2] := real($native_flute_position_random ) / 1000000.0

    set_control_par_str( get_ui_id( $native_flute_position ), $CONTROL_PAR_LABEL, $native_flute_position_random / 10000 & "%" )
    set_control_par_str( get_ui_id( $native_flute_position_random_label ), $CONTROL_PAR_TEXT, "    " & $native_flute_position_random / 10000 & "%" )

    wait($ui_wait)
    if(%callback_ids[37] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($native_flute_position_random_label), $CONTROL_PAR_TEXT, "RANDOM")
    end if
end on

on ui_control( $native_flute_volume )
    %callback_ids[38] := $NI_CALLBACK_ID
    set_engine_par($ENGINE_PAR_VOLUME, $native_flute_volume, 4, 0, -1) {Set volume for Native Flute}
    set_engine_par($ENGINE_PAR_VOLUME, $native_flute_volume, 5, 0, -1) {Set volume for Native Flute Reversed}

    set_control_par_str( get_ui_id( $native_flute_volume ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_VOLUME, 4, 0, -1 ) & " dB" )
    set_control_par_str( get_ui_id( $native_flute_volume_label ), $CONTROL_PAR_TEXT, "  " & get_engine_par_disp( $ENGINE_PAR_VOLUME, 4, 0, -1 ) & " dB" )

    wait($ui_wait)
    if(%callback_ids[38] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($native_flute_volume_label), $CONTROL_PAR_TEXT, "VOLUME")
    end if
end on

{Guitar Related}
on ui_control( $guitar_toggle_button )
    %instrument_active[3] := $guitar_toggle_button
end on

on ui_control( $guitar_reverse_button )
    if($guitar_reverse_button = 1)
        %instrument_reverse[3] := 1
    else
        %instrument_reverse[3] := 0
    end if
end on

on ui_control( $guitar_position )
    %instrument_position[3] := $guitar_position
end on

on ui_control( $guitar_position_random )
    %callback_ids[39] := $NI_CALLBACK_ID
    ?instrument_position_randomness[3] := real($guitar_position_random ) / 1000000.0

    set_control_par_str( get_ui_id( $guitar_position ), $CONTROL_PAR_LABEL, $guitar_position_random / 10000 & "%" )
    set_control_par_str( get_ui_id( $guitar_position_random_label ), $CONTROL_PAR_TEXT, "    " & $guitar_position_random / 10000 & "%" )

    wait($ui_wait)
    if(%callback_ids[39] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($guitar_position_random_label), $CONTROL_PAR_TEXT, "RANDOM")
    end if
end on

on ui_control( $guitar_volume )
    %callback_ids[40] := $NI_CALLBACK_ID
    set_engine_par($ENGINE_PAR_VOLUME, $guitar_volume, 6, 0, -1) {Set volume for Guitar}
    set_engine_par($ENGINE_PAR_VOLUME, $guitar_volume, 7, 0, -1) {Set volume for Guitar Reversed}

    set_control_par_str( get_ui_id( $guitar_volume ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_VOLUME, 6, 0, -1 ) & " dB" )
    set_control_par_str( get_ui_id( $guitar_volume_label ), $CONTROL_PAR_TEXT, "  " & get_engine_par_disp( $ENGINE_PAR_VOLUME, 6, 0, -1 ) & " dB" )

    wait($ui_wait)
    if(%callback_ids[40] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($guitar_volume_label), $CONTROL_PAR_TEXT, "VOLUME")
    end if
end on

{Vocal Related}
on ui_control( $vocal_toggle_button )
    %instrument_active[5] := $vocal_toggle_button
end on

on ui_control( $vocal_reverse_button )
    if($vocal_reverse_button = 1)
        %instrument_reverse[5] := 1
    else
        %instrument_reverse[5] := 0
    end if
end on

on ui_control( $vocal_position )
    %instrument_position[5] := $vocal_position
end on

on ui_control( $vocal_position_random )
    %callback_ids[43] := $NI_CALLBACK_ID
    ?instrument_position_randomness[5] := real($vocal_position_random ) / 1000000.0

    set_control_par_str( get_ui_id( $vocal_position ), $CONTROL_PAR_LABEL, $vocal_position_random / 10000 & "%" )
    set_control_par_str( get_ui_id( $vocal_position_random_label ), $CONTROL_PAR_TEXT, "    " & $vocal_position_random / 10000 & "%" )

    wait($ui_wait)
    if(%callback_ids[43] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($vocal_position_random_label), $CONTROL_PAR_TEXT, "RANDOM")
    end if
end on

on ui_control( $vocal_volume )
    %callback_ids[44] := $NI_CALLBACK_ID
    set_engine_par($ENGINE_PAR_VOLUME, $vocal_volume, 10, 0, -1) {Set volume for Vocal}
    set_engine_par($ENGINE_PAR_VOLUME, $vocal_volume, 11, 0, -1) {Set volume for Vocal Reversed}

    set_control_par_str( get_ui_id( $vocal_volume ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_VOLUME, 10, 0, -1 ) & " dB" )
    set_control_par_str( get_ui_id( $vocal_volume_label ), $CONTROL_PAR_TEXT, "  " & get_engine_par_disp( $ENGINE_PAR_VOLUME, 10, 0, -1 ) & " dB" )

    wait($ui_wait)
    if(%callback_ids[44] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($vocal_volume_label), $CONTROL_PAR_TEXT, "VOLUME")
    end if
end on


{Saw Pluck Related}
on ui_control( $sawpluck_toggle_button )
    %instrument_active[4] := $sawpluck_toggle_button
end on

on ui_control( $sawpluck_reverse_button )
    if($sawpluck_reverse_button = 1)
        %instrument_reverse[4] := 1
    else
        %instrument_reverse[4] := 0
    end if
end on

on ui_control( $sawpluck_position )
    %instrument_position[4] := $sawpluck_position
end on

on ui_control( $sawpluck_position_random )
    %callback_ids[41] := $NI_CALLBACK_ID
    ?instrument_position_randomness[4] := real($sawpluck_position_random ) / 1000000.0

    set_control_par_str( get_ui_id( $sawpluck_position ), $CONTROL_PAR_LABEL, $sawpluck_position_random / 10000 & "%" )
    set_control_par_str( get_ui_id( $sawpluck_position_random_label ), $CONTROL_PAR_TEXT, "    " & $sawpluck_position_random / 10000 & "%" )

    wait($ui_wait)
    if(%callback_ids[41] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($sawpluck_position_random_label), $CONTROL_PAR_TEXT, "RANDOM")
    end if
end on

on ui_control( $sawpluck_volume )
    %callback_ids[42] := $NI_CALLBACK_ID
    set_engine_par($ENGINE_PAR_VOLUME, $sawpluck_volume, 8, 0, -1) {Set volume for Saw Pluck}
    set_engine_par($ENGINE_PAR_VOLUME, $sawpluck_volume, 9, 0, -1) {Set volume for Saw Pluck Reversed}

    set_control_par_str( get_ui_id( $sawpluck_volume ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_VOLUME, 8, 0, -1 ) & " dB" )
    set_control_par_str( get_ui_id( $sawpluck_volume_label ), $CONTROL_PAR_TEXT, "  " & get_engine_par_disp( $ENGINE_PAR_VOLUME, 8, 0, -1 ) & " dB" )

    wait($ui_wait)
    if(%callback_ids[42] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($sawpluck_volume_label), $CONTROL_PAR_TEXT, "VOLUME")
    end if
end on

{Piano Related}
on ui_control( $piano_toggle_button )
    %instrument_active[6] := $piano_toggle_button
end on

on ui_control( $piano_reverse_button )
    if($piano_reverse_button = 1)
        %instrument_reverse[6] := 1
    else
        %instrument_reverse[6] := 0
    end if
end on

on ui_control( $piano_position )
    %instrument_position[6] := $piano_position
end on

on ui_control( $piano_position_random )
    %callback_ids[45] := $NI_CALLBACK_ID
    ?instrument_position_randomness[6] := real($piano_position_random ) / 1000000.0

    set_control_par_str( get_ui_id( $piano_position ), $CONTROL_PAR_LABEL, $piano_position_random / 10000 & "%" )
    set_control_par_str( get_ui_id( $piano_position_random_label ), $CONTROL_PAR_TEXT, "    " & $piano_position_random / 10000 & "%" )

    wait($ui_wait)
    if(%callback_ids[45] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($piano_position_random_label), $CONTROL_PAR_TEXT, "RANDOM")
    end if
end on

on ui_control( $piano_volume )
    %callback_ids[46] := $NI_CALLBACK_ID
    set_engine_par($ENGINE_PAR_VOLUME, $piano_volume, 12, 0, -1) {Set volume for Piano}
    set_engine_par($ENGINE_PAR_VOLUME, $piano_volume, 13, 0, -1) {Set volume for Piano Reversed}

    set_control_par_str( get_ui_id( $piano_volume ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_VOLUME, 12, 0, -1 ) & " dB" )
    set_control_par_str( get_ui_id( $piano_volume_label ), $CONTROL_PAR_TEXT, "  " & get_engine_par_disp( $ENGINE_PAR_VOLUME, 12, 0, -1 ) & " dB" )

    wait($ui_wait)
    if(%callback_ids[46] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($piano_volume_label), $CONTROL_PAR_TEXT, "VOLUME")
    end if
end on

{Ethereal Related}
on ui_control( $ethereal_toggle_button )
    %instrument_active[7] := $ethereal_toggle_button
end on

on ui_control( $ethereal_reverse_button )
    if($ethereal_reverse_button = 1)
        %instrument_reverse[7] := 1
    else
        %instrument_reverse[7] := 0
    end if
end on

on ui_control( $ethereal_position )
    %instrument_position[7] := $ethereal_position
end on

on ui_control( $ethereal_position_random )
    %callback_ids[47] := $NI_CALLBACK_ID
    ?instrument_position_randomness[7] := real($ethereal_position_random ) / 1000000.0

    set_control_par_str( get_ui_id( $ethereal_position ), $CONTROL_PAR_LABEL, $ethereal_position_random / 10000 & "%" )
    set_control_par_str( get_ui_id( $ethereal_position_random_label ), $CONTROL_PAR_TEXT, "    " & $ethereal_position_random / 10000 & "%" )

    wait($ui_wait)
    if(%callback_ids[47] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($ethereal_position_random_label), $CONTROL_PAR_TEXT, "RANDOM")
    end if
end on

on ui_control( $ethereal_volume )
    %callback_ids[48] := $NI_CALLBACK_ID
    set_engine_par($ENGINE_PAR_VOLUME, $ethereal_volume, 14, 0, -1) {Set volume for Ethereal}
    set_engine_par($ENGINE_PAR_VOLUME, $ethereal_volume, 15, 0, -1) {Set volume for Ethereal Reversed}

    set_control_par_str( get_ui_id( $ethereal_volume ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_VOLUME, 14, 0, -1 ) & " dB" )
    set_control_par_str( get_ui_id( $ethereal_volume_label ), $CONTROL_PAR_TEXT, "  " & get_engine_par_disp( $ENGINE_PAR_VOLUME, 14, 0, -1 ) & " dB" )

    wait($ui_wait)
    if(%callback_ids[48] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($ethereal_volume_label), $CONTROL_PAR_TEXT, "VOLUME")
    end if
end on

{Sine Pluck Related}
on ui_control( $sinepluck_toggle_button )
    %instrument_active[8] := $sinepluck_toggle_button
end on

on ui_control( $sinepluck_reverse_button )
    if($sinepluck_reverse_button = 1)
        %instrument_reverse[8] := 1
    else
        %instrument_reverse[8] := 0
    end if
end on

on ui_control( $sinepluck_position )
    %instrument_position[8] := $sinepluck_position
end on

on ui_control( $sinepluck_position_random )
    %callback_ids[49] := $NI_CALLBACK_ID
    ?instrument_position_randomness[8] := real($sinepluck_position_random ) / 1000000.0

    set_control_par_str( get_ui_id( $sinepluck_position ), $CONTROL_PAR_LABEL, $sinepluck_position_random / 10000 & "%" )
    set_control_par_str( get_ui_id( $sinepluck_position_random_label ), $CONTROL_PAR_TEXT, "    " & $sinepluck_position_random / 10000 & "%" )

    wait($ui_wait)
    if(%callback_ids[49] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($sinepluck_position_random_label), $CONTROL_PAR_TEXT, "RANDOM")
    end if
end on

on ui_control( $sinepluck_volume )
    %callback_ids[50] := $NI_CALLBACK_ID
    set_engine_par($ENGINE_PAR_VOLUME, $sinepluck_volume, 16, 0, -1) {Set volume for Sine Pluck}
    set_engine_par($ENGINE_PAR_VOLUME, $sinepluck_volume, 17, 0, -1) {Set volume for Sine Pluck Reversed}

    set_control_par_str( get_ui_id( $sinepluck_volume ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_VOLUME, 16, 0, -1 ) & " dB" )
    set_control_par_str( get_ui_id( $sinepluck_volume_label ), $CONTROL_PAR_TEXT, "  " & get_engine_par_disp( $ENGINE_PAR_VOLUME, 16, 0, -1 ) & " dB" )

    wait($ui_wait)
    if(%callback_ids[50] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($sinepluck_volume_label), $CONTROL_PAR_TEXT, "VOLUME")
    end if
end on

{Water Drop Related}
on ui_control( $waterdrop_toggle_button )
    %instrument_active[9] := $waterdrop_toggle_button
end on

on ui_control( $waterdrop_reverse_button )
    if($waterdrop_reverse_button = 1)
        %instrument_reverse[9] := 1
    else
        %instrument_reverse[9] := 0
    end if
end on

on ui_control( $waterdrop_position )
    %instrument_position[9] := $waterdrop_position
end on

on ui_control( $waterdrop_position_random )
    %callback_ids[51] := $NI_CALLBACK_ID
    ?instrument_position_randomness[9] := real($waterdrop_position_random ) / 1000000.0

    set_control_par_str( get_ui_id( $waterdrop_position ), $CONTROL_PAR_LABEL, $waterdrop_position_random / 10000 & "%" )
    set_control_par_str( get_ui_id( $waterdrop_position_random_label ), $CONTROL_PAR_TEXT, "    " & $waterdrop_position_random / 10000 & "%" )

    wait($ui_wait)
    if(%callback_ids[51] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($waterdrop_position_random_label), $CONTROL_PAR_TEXT, "RANDOM")
    end if
end on

on ui_control( $waterdrop_volume )
    %callback_ids[52] := $NI_CALLBACK_ID
    set_engine_par($ENGINE_PAR_VOLUME, $waterdrop_volume, 18, 0, -1) {Set volume for Water Drop}
    set_engine_par($ENGINE_PAR_VOLUME, $waterdrop_volume, 19, 0, -1) {Set volume for Water Drop Reversed}

    set_control_par_str( get_ui_id( $waterdrop_volume ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_VOLUME, 18, 0, -1 ) & " dB" )
    set_control_par_str( get_ui_id( $waterdrop_volume_label ), $CONTROL_PAR_TEXT, "  " & get_engine_par_disp( $ENGINE_PAR_VOLUME, 18, 0, -1 ) & " dB" )

    wait($ui_wait)
    if(%callback_ids[52] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($waterdrop_volume_label), $CONTROL_PAR_TEXT, "VOLUME")
    end if
end on

{LFO Related}
on ui_control($lfo_freq)
    %callback_ids[27] := $NI_CALLBACK_ID
    $count := 0
    while ( $count < $instrument_number * 2 )
        set_engine_par($ENGINE_PAR_INTMOD_FREQUENCY, $lfo_freq, $count, get_mod_idx( $count,"LFO"), -1)
        inc( $count )
    end while

    set_control_par_str(get_ui_id($lfo_freq), $CONTROL_PAR_LABEL, get_engine_par_disp($ENGINE_PAR_INTMOD_FREQUENCY, 0, get_mod_idx( 0,"LFO"), -1) & " Hz")
    set_control_par_str(get_ui_id($lfo_freq_label), $CONTROL_PAR_TEXT, get_engine_par_disp($ENGINE_PAR_INTMOD_FREQUENCY, 0, get_mod_idx( 0,"LFO"), -1) & " Hz")

    wait($ui_wait)
    if(%callback_ids[27] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($lfo_freq_label), $CONTROL_PAR_TEXT, " FREQ")
    end if
end on

on ui_control($lfo_depth)
    %callback_ids[28] := $NI_CALLBACK_ID
    $count := 0
    while ( $count < $instrument_number * 2 )
        set_engine_par($ENGINE_PAR_INTMOD_INTENSITY, $lfo_depth, $count, get_mod_idx( $count,"LFO"), -1)
        inc( $count )
    end while

    set_control_par_str(get_ui_id($lfo_depth), $CONTROL_PAR_LABEL, get_engine_par_disp($ENGINE_PAR_INTMOD_INTENSITY, 0, get_mod_idx( 0,"LFO"), -1) & " %")
    set_control_par_str(get_ui_id($lfo_depth_label), $CONTROL_PAR_TEXT, get_engine_par_disp($ENGINE_PAR_INTMOD_INTENSITY, 0, get_mod_idx( 0,"LFO"), -1) & " %")

    wait($ui_wait)
    if(%callback_ids[28] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($lfo_depth_label), $CONTROL_PAR_TEXT, "DEPTH")
    end if
end on

on ui_control($lfo_fade_in)
    %callback_ids[29] := $NI_CALLBACK_ID
    $count := 0
    while ( $count < $instrument_number * 2 )
        set_engine_par($ENGINE_PAR_LFO_DELAY, $lfo_fade_in, $count, get_mod_idx( $count,"LFO"), -1)
        inc( $count )
    end while

    set_control_par_str(get_ui_id($lfo_fade_in), $CONTROL_PAR_LABEL, get_engine_par_disp($ENGINE_PAR_LFO_DELAY, 0, get_mod_idx( 0,"LFO"), -1) & " ms")
    set_control_par_str(get_ui_id($lfo_fade_in_label), $CONTROL_PAR_TEXT, get_engine_par_disp($ENGINE_PAR_LFO_DELAY, 0, get_mod_idx( 0,"LFO"), -1) & " ms")

    wait($ui_wait)
    if(%callback_ids[29] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($lfo_fade_in_label), $CONTROL_PAR_TEXT, "FADE IN")
    end if
end on

{Effects Related}

on ui_control( $effects_bypass_all )
    if ( %bypassed[0] = 0 )
        set_control_par( get_ui_id( $reverb_bypass_button ), $CONTROL_PAR_VALUE, $effects_bypass_all )
        set_engine_par( $ENGINE_PAR_SEND_EFFECT_BYPASS, $reverb_bypass_button, -1, 0, $NI_MAIN_BUS ) 
    end if

    if ( %bypassed[1] = 0 )
        set_control_par( get_ui_id( $filter_bypass_button ), $CONTROL_PAR_VALUE, $effects_bypass_all )
        set_engine_par( $ENGINE_PAR_EFFECT_BYPASS, $filter_bypass_button, -1, 1, $NI_MAIN_BUS ) {Bypass LOW CUT filter}
        set_engine_par( $ENGINE_PAR_EFFECT_BYPASS, $filter_bypass_button, -1, 2, $NI_MAIN_BUS ) {Bypass HIGH CUT filter}
    end if

    if ( %bypassed[2] = 0 )
        set_control_par( get_ui_id( $psyche_delay_bypass_button ), $CONTROL_PAR_VALUE, $effects_bypass_all )
        set_engine_par( $ENGINE_PAR_SEND_EFFECT_BYPASS, $psyche_delay_bypass_button, -1, 0, $NI_SEND_BUS ) 
    end if

    if ( %bypassed[3] = 0 )
        set_control_par( get_ui_id( $replika_delay_bypass_button ), $CONTROL_PAR_VALUE, $effects_bypass_all )
        set_engine_par( $ENGINE_PAR_SEND_EFFECT_BYPASS, $replika_delay_bypass_button, -1, 1, $NI_SEND_BUS ) 
    end if
end on

    {Reverb}
on ui_control( $reverb_amount )
    %callback_ids[9] := $NI_CALLBACK_ID
    set_engine_par( $ENGINE_PAR_SEND_EFFECT_OUTPUT_GAIN, $reverb_amount, -1, 0, $NI_MAIN_BUS )

    set_control_par_str( get_ui_id( $reverb_amount ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_SEND_EFFECT_OUTPUT_GAIN, -1, 0, $NI_MAIN_BUS ) & " dB" )
    set_control_par_str( get_ui_id( $reverb_amount_label ), $CONTROL_PAR_TEXT, "  " & get_engine_par_disp( $ENGINE_PAR_SEND_EFFECT_OUTPUT_GAIN, -1, 0, $NI_MAIN_BUS ) & " dB" )

    wait($ui_wait)
    if(%callback_ids[9] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($reverb_amount_label), $CONTROL_PAR_TEXT, "AMOUNT")
    end if
end on

on ui_control( $reverb_pre_delay )
    %callback_ids[10] := $NI_CALLBACK_ID
    set_engine_par( $ENGINE_PAR_RV2_PREDELAY, $reverb_pre_delay, -1, 0, $NI_MAIN_BUS )

    set_control_par_str( get_ui_id( $reverb_pre_delay ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_RV2_PREDELAY, -1, 0, $NI_MAIN_BUS ) & " ms" )
    set_control_par_str( get_ui_id( $reverb_pre_delay_label ), $CONTROL_PAR_TEXT, "  " & get_engine_par_disp( $ENGINE_PAR_RV2_PREDELAY, -1, 0, $NI_MAIN_BUS ) & " ms" )

    wait($ui_wait)
    if(%callback_ids[10] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($reverb_pre_delay_label), $CONTROL_PAR_TEXT, "PRE-DELAY")
    end if
end on

on ui_control( $reverb_time )
    %callback_ids[11] := $NI_CALLBACK_ID
    set_engine_par( $ENGINE_PAR_RV2_TIME, $reverb_time, -1, 0, $NI_MAIN_BUS )

    set_control_par_str( get_ui_id( $reverb_time ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_RV2_TIME, -1, 0, $NI_MAIN_BUS ) & " ms" )
    set_control_par_str( get_ui_id( $reverb_time_label ), $CONTROL_PAR_TEXT, get_engine_par_disp( $ENGINE_PAR_RV2_TIME, -1, 0, $NI_MAIN_BUS ) & " ms" )

    wait($ui_wait)
    if(%callback_ids[11] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($reverb_time_label), $CONTROL_PAR_TEXT, "TIME")
    end if
end on

on ui_control( $reverb_size )
    %callback_ids[12] := $NI_CALLBACK_ID
    set_engine_par( $ENGINE_PAR_RV2_SIZE, $reverb_size, -1, 0, $NI_MAIN_BUS )

    set_control_par_str( get_ui_id( $reverb_size ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_RV2_SIZE, -1, 0, $NI_MAIN_BUS ) & " %" )
    set_control_par_str( get_ui_id( $reverb_size_label ), $CONTROL_PAR_TEXT, get_engine_par_disp( $ENGINE_PAR_RV2_SIZE, -1, 0, $NI_MAIN_BUS ) & " %" )

    wait($ui_wait)
    if(%callback_ids[12] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($reverb_size_label), $CONTROL_PAR_TEXT, "SIZE")
    end if
end on

on ui_control( $reverb_stereo )
    %callback_ids[13] := $NI_CALLBACK_ID
    set_engine_par( $ENGINE_PAR_RV2_STEREO, $reverb_stereo, -1, 0, $NI_MAIN_BUS )

    set_control_par_str( get_ui_id( $reverb_stereo ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_RV2_STEREO, -1, 0, $NI_MAIN_BUS ) & " %" )
    set_control_par_str( get_ui_id( $reverb_stereo_label ), $CONTROL_PAR_TEXT, get_engine_par_disp( $ENGINE_PAR_RV2_STEREO, -1, 0, $NI_MAIN_BUS ) & " %" )

    wait($ui_wait)
    if(%callback_ids[13] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($reverb_stereo_label), $CONTROL_PAR_TEXT, "STEREO")
    end if
end on

on ui_control( $reverb_low_shelf )
    %callback_ids[14] := $NI_CALLBACK_ID
    set_engine_par( $ENGINE_PAR_RV2_LOWSHELF, $reverb_low_shelf, -1, 0, $NI_MAIN_BUS )

    set_control_par_str( get_ui_id( $reverb_low_shelf ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_RV2_LOWSHELF, -1, 0, $NI_MAIN_BUS ) & " dB" )
    set_control_par_str( get_ui_id( $reverb_low_shelf_label ), $CONTROL_PAR_TEXT, "   " & get_engine_par_disp( $ENGINE_PAR_RV2_LOWSHELF, -1, 0, $NI_MAIN_BUS ) & " dB" )

    wait($ui_wait)
    if(%callback_ids[14] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($reverb_low_shelf_label), $CONTROL_PAR_TEXT, "LOW SHELF")
    end if
end on

on ui_control( $reverb_high_cut )
    %callback_ids[15] := $NI_CALLBACK_ID
    set_engine_par( $ENGINE_PAR_RV2_HIGHCUT, 1000000 - $reverb_high_cut, -1, 0, $NI_MAIN_BUS )

    set_control_par_str( get_ui_id( $reverb_high_cut ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_RV2_HIGHCUT, -1, 0, $NI_MAIN_BUS ) & " Hz" )
    set_control_par_str( get_ui_id( $reverb_high_cut_label ), $CONTROL_PAR_TEXT, "   " & get_engine_par_disp( $ENGINE_PAR_RV2_HIGHCUT, -1, 0, $NI_MAIN_BUS ) & " Hz" )

    wait($ui_wait)
    if(%callback_ids[15] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($reverb_high_cut_label), $CONTROL_PAR_TEXT, "HIGH CUT")
    end if
end on

on ui_control( $reverb_bypass_button )
    set_engine_par( $ENGINE_PAR_SEND_EFFECT_BYPASS, $reverb_bypass_button, -1, 0, $NI_MAIN_BUS )
    %bypassed[0] := $reverb_bypass_button 

    if( %bypassed[0] = 0 )
        set_control_par( get_ui_id( $effects_bypass_all ), $CONTROL_PAR_VALUE, 0 ) 
    end if
end on

    {Filter}
on ui_control( $filter_lowcut )
    %callback_ids[16] := $NI_CALLBACK_ID
    set_engine_par( $ENGINE_PAR_CUTOFF, $filter_lowcut, -1, 1, $NI_MAIN_BUS )

    set_control_par_str( get_ui_id( $filter_lowcut ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_CUTOFF, -1, 1, $NI_MAIN_BUS ) & " Hz" )
    set_control_par_str( get_ui_id( $filter_lowcut_label ), $CONTROL_PAR_TEXT, get_engine_par_disp( $ENGINE_PAR_CUTOFF, -1, 1, $NI_MAIN_BUS ) & " Hz" )
    
    wait($ui_wait)
    if(%callback_ids[16] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($filter_lowcut_label), $CONTROL_PAR_TEXT, "LOW CUT")
    end if
end on

on ui_control( $filter_lowcut_resonance )
    %callback_ids[17] := $NI_CALLBACK_ID
    set_engine_par( $ENGINE_PAR_RESONANCE, $filter_lowcut_resonance, -1, 1, $NI_MAIN_BUS )

    set_control_par_str( get_ui_id( $filter_lowcut_resonance ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_RESONANCE, -1, 1, $NI_MAIN_BUS ) & " %" )
    set_control_par_str( get_ui_id( $filter_lowcut_resonance_label ), $CONTROL_PAR_TEXT, get_engine_par_disp( $ENGINE_PAR_RESONANCE, -1, 1, $NI_MAIN_BUS ) & " %" )
    
    wait($ui_wait)
    if(%callback_ids[17] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($filter_lowcut_resonance_label), $CONTROL_PAR_TEXT, "LC RES")
    end if
end on

on ui_control( $filter_highcut )
    %callback_ids[18] := $NI_CALLBACK_ID
    set_engine_par( $ENGINE_PAR_CUTOFF, $filter_highcut, -1, 2, $NI_MAIN_BUS )

    set_control_par_str( get_ui_id( $filter_highcut ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_CUTOFF, -1, 2, $NI_MAIN_BUS ) & " Hz" )
    set_control_par_str( get_ui_id( $filter_highcut_label ), $CONTROL_PAR_TEXT, get_engine_par_disp( $ENGINE_PAR_CUTOFF, -1, 2, $NI_MAIN_BUS ) & " Hz" )

    wait($ui_wait)
    if(%callback_ids[18] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($filter_highcut_label), $CONTROL_PAR_TEXT, "HIGH CUT")
    end if
end on

on ui_control( $filter_highcut_resonance )
    %callback_ids[19] := $NI_CALLBACK_ID
    set_engine_par( $ENGINE_PAR_RESONANCE, $filter_highcut_resonance, -1, 2, $NI_MAIN_BUS )

    set_control_par_str( get_ui_id( $filter_highcut_resonance ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_RESONANCE, -1, 2, $NI_MAIN_BUS ) & " %" )
    set_control_par_str( get_ui_id( $filter_highcut_resonance_label ), $CONTROL_PAR_TEXT, get_engine_par_disp( $ENGINE_PAR_RESONANCE, -1, 2, $NI_MAIN_BUS ) & " %" )
    
    wait($ui_wait)
    if(%callback_ids[19] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($filter_highcut_resonance_label), $CONTROL_PAR_TEXT, "HC RES")
    end if
end on

on ui_control( $filter_bypass_button )
    set_engine_par( $ENGINE_PAR_EFFECT_BYPASS, $filter_bypass_button, -1, 1, $NI_MAIN_BUS ) {Bypass LOW CUT filter}
    set_engine_par( $ENGINE_PAR_EFFECT_BYPASS, $filter_bypass_button, -1, 2, $NI_MAIN_BUS ) {Bypass HIGH CUT filter}
    %bypassed[1] := $filter_bypass_button {Store the bypass state of the filter}

    if( %bypassed[1] = 0 )
        set_control_par( get_ui_id( $effects_bypass_all ), $CONTROL_PAR_VALUE, 0 ) 
    end if
end on

    {Psyche Delay}
on ui_control( $psyche_delay_toggle_button )
    if($psyche_delay_toggle_button = 0)
        set_control_par( get_ui_id( $PsycheDelaySettingsPanel ), $CONTROL_PAR_HIDE, $HIDE_WHOLE_CONTROL )

        set_control_par( get_ui_id( $psyche_delay_bypass_button ), $CONTROL_PAR_VALUE, 1 )
        set_engine_par( $ENGINE_PAR_SEND_EFFECT_BYPASS, $psyche_delay_bypass_button, -1, 0, $NI_SEND_BUS ) 
        %bypassed[2] := $psyche_delay_bypass_button {Store the bypass state of the psyche delay}

        set_control_par( get_ui_id( $replika_delay_toggle_button ), $CONTROL_PAR_VALUE, 1 ) 
        set_control_par( get_ui_id( $ReplikaDelaySettingsPanel ), $CONTROL_PAR_HIDE, $HIDE_PART_NOTHING )

        set_control_par( get_ui_id( $replika_delay_bypass_button ), $CONTROL_PAR_VALUE, 0 ) 
        set_engine_par( $ENGINE_PAR_SEND_EFFECT_BYPASS, $replika_delay_bypass_button, -1, 1, $NI_SEND_BUS )
        %bypassed[3] := $replika_delay_bypass_button {Store the bypass state of the replika delay}
    else
        set_control_par( get_ui_id( $replika_delay_toggle_button ), $CONTROL_PAR_VALUE, 0 ) 
        set_control_par( get_ui_id( $PsycheDelaySettingsPanel ), $CONTROL_PAR_HIDE, $HIDE_PART_NOTHING )

        set_control_par( get_ui_id( $psyche_delay_bypass_button ), $CONTROL_PAR_VALUE, 0 ) 
        set_engine_par( $ENGINE_PAR_SEND_EFFECT_BYPASS, $psyche_delay_bypass_button, -1, 0, $NI_SEND_BUS ) 
        %bypassed[2] := $psyche_delay_bypass_button {Store the bypass state of the psyche delay}

        set_control_par( get_ui_id( $ReplikaDelaySettingsPanel ), $CONTROL_PAR_HIDE, $HIDE_WHOLE_CONTROL )

        set_control_par( get_ui_id( $replika_delay_bypass_button ), $CONTROL_PAR_VALUE, 1 ) 
        set_engine_par( $ENGINE_PAR_SEND_EFFECT_BYPASS, $replika_delay_bypass_button, -1, 1, $NI_SEND_BUS )
        %bypassed[3] := $replika_delay_bypass_button {Store the bypass state of the replika delay}
    end if

    set_control_par( get_ui_id( $effects_bypass_all ), $CONTROL_PAR_VALUE, 0 ) {Reset the bypass all button}

end on

on ui_control( $psyche_delay_amount )
    %callback_ids[20] := $NI_CALLBACK_ID
    set_engine_par( $ENGINE_PAR_SEND_EFFECT_OUTPUT_GAIN, $psyche_delay_amount, -1, 0, $NI_SEND_BUS )

    set_control_par_str( get_ui_id( $psyche_delay_amount ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_SEND_EFFECT_OUTPUT_GAIN, -1, 0, $NI_SEND_BUS ) & " dB" )
    set_control_par_str( get_ui_id( $psyche_delay_amount_label ), $CONTROL_PAR_TEXT, get_engine_par_disp( $ENGINE_PAR_SEND_EFFECT_OUTPUT_GAIN, -1, 0, $NI_SEND_BUS ) & " dB" )

    wait($ui_wait)
    if(%callback_ids[20] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($psyche_delay_amount_label), $CONTROL_PAR_TEXT, "AMOUNT")
    end if
end on

on ui_control( $psyche_delay_time )
    %callback_ids[21] := $NI_CALLBACK_ID
    set_engine_par( $ENGINE_PAR_PSYDL_TIME, $psyche_delay_time, -1, 0, $NI_SEND_BUS )

    set_control_par_str( get_ui_id( $psyche_delay_time ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_PSYDL_TIME, -1, 0, $NI_SEND_BUS ) & " ms" )
    set_control_par_str( get_ui_id( $psyche_delay_time_label ), $CONTROL_PAR_TEXT, get_engine_par_disp( $ENGINE_PAR_PSYDL_TIME, -1, 0, $NI_SEND_BUS ) & " ms" )

    wait($ui_wait)
    if(%callback_ids[21] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($psyche_delay_time_label), $CONTROL_PAR_TEXT, "TIME")
    end if
end on

on ui_control( $psyche_delay_feedback )
    %callback_ids[22] := $NI_CALLBACK_ID
    set_engine_par( $ENGINE_PAR_PSYDL_FEEDBACK, $psyche_delay_feedback, -1, 0, $NI_SEND_BUS )

    set_control_par_str( get_ui_id( $psyche_delay_feedback ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_PSYDL_FEEDBACK, -1, 0, $NI_SEND_BUS ) & " %" )
    set_control_par_str( get_ui_id( $psyche_delay_feedback_label ), $CONTROL_PAR_TEXT, "    " & get_engine_par_disp( $ENGINE_PAR_PSYDL_FEEDBACK, -1, 0, $NI_SEND_BUS ) & " %" )

    wait($ui_wait)
    if(%callback_ids[22] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($psyche_delay_feedback_label), $CONTROL_PAR_TEXT, "FEEDBACK")
    end if
end on

on ui_control( $psyche_delay_lr_offset )
    %callback_ids[23] := $NI_CALLBACK_ID
    set_engine_par( $ENGINE_PAR_PSYDL_LR_OFFSET, $psyche_delay_lr_offset, -1, 0, $NI_SEND_BUS )

    set_control_par_str( get_ui_id( $psyche_delay_lr_offset ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_PSYDL_LR_OFFSET, -1, 0, $NI_SEND_BUS ) & " %" )
    set_control_par_str( get_ui_id( $psyche_delay_lr_offset_label ), $CONTROL_PAR_TEXT, "    " & get_engine_par_disp( $ENGINE_PAR_PSYDL_LR_OFFSET, -1, 0, $NI_SEND_BUS ) & " %" )

    wait($ui_wait)
    if(%callback_ids[23] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($psyche_delay_lr_offset_label), $CONTROL_PAR_TEXT, "LR OFFSET")
    end if
end on

on ui_control( $psyche_delay_cross_fb )
    %callback_ids[24] := $NI_CALLBACK_ID
    set_engine_par( $ENGINE_PAR_PSYDL_CROSS_FEEDBACK, $psyche_delay_cross_fb, -1, 0, $NI_SEND_BUS )

    set_control_par_str( get_ui_id( $psyche_delay_cross_fb ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_PSYDL_CROSS_FEEDBACK, -1, 0, $NI_SEND_BUS ) & " %" )
    set_control_par_str( get_ui_id( $psyche_delay_cross_fb_label ), $CONTROL_PAR_TEXT, "    " & get_engine_par_disp( $ENGINE_PAR_PSYDL_CROSS_FEEDBACK, -1, 0, $NI_SEND_BUS ) & " %" )

    wait($ui_wait)
    if(%callback_ids[24] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($psyche_delay_cross_fb_label), $CONTROL_PAR_TEXT, "CROSS FB")
    end if
end on

on ui_control( $psyche_delay_pitch )
    %callback_ids[25] := $NI_CALLBACK_ID
    set_engine_par( $ENGINE_PAR_PSYDL_PITCH, $psyche_delay_pitch, -1, 0, $NI_SEND_BUS )

    set_control_par_str( get_ui_id( $psyche_delay_pitch ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_PSYDL_PITCH, -1, 0, $NI_SEND_BUS ) & " st" )
    set_control_par_str( get_ui_id( $psyche_delay_pitch_label ), $CONTROL_PAR_TEXT, " " & get_engine_par_disp( $ENGINE_PAR_PSYDL_PITCH, -1, 0, $NI_SEND_BUS ) & " st" )

    wait($ui_wait)
    if(%callback_ids[25] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($psyche_delay_pitch_label), $CONTROL_PAR_TEXT, "PITCH")
    end if
end on

on ui_control( $psyche_delay_detune )
    %callback_ids[26] := $NI_CALLBACK_ID
    set_engine_par( $ENGINE_PAR_PSYDL_DETUNE, $psyche_delay_detune, -1, 0, $NI_SEND_BUS )

    set_control_par_str( get_ui_id( $psyche_delay_detune ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_PSYDL_DETUNE, -1, 0, $NI_SEND_BUS ) & " cts" )
    set_control_par_str( get_ui_id( $psyche_delay_detune_label ), $CONTROL_PAR_TEXT, " " & get_engine_par_disp( $ENGINE_PAR_PSYDL_DETUNE, -1, 0, $NI_SEND_BUS ) & " cts" )

    wait($ui_wait)
    if(%callback_ids[26] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($psyche_delay_detune_label), $CONTROL_PAR_TEXT, "DETUNE")
    end if
end on

on ui_control( $psyche_delay_reversed_button)
    set_engine_par( $ENGINE_PAR_PSYDL_REVERSE, $psyche_delay_reversed_button, -1, 0, $NI_SEND_BUS )
end on

on ui_control( $psyche_delay_bypass_button )
    set_engine_par( $ENGINE_PAR_SEND_EFFECT_BYPASS, $psyche_delay_bypass_button, -1, 0, $NI_SEND_BUS ) 
    %bypassed[2] := $psyche_delay_bypass_button {Store the bypass state of the psyche delay}

    if( %bypassed[2] = 0 )
        set_control_par( get_ui_id( $effects_bypass_all ), $CONTROL_PAR_VALUE, 0 ) 
    end if
end on

    {Replika Delay}
on ui_control( $replika_delay_toggle_button )
    if($replika_delay_toggle_button = 0)
        set_control_par( get_ui_id( $ReplikaDelaySettingsPanel ), $CONTROL_PAR_HIDE, $HIDE_WHOLE_CONTROL )

        set_control_par( get_ui_id( $replika_delay_bypass_button ), $CONTROL_PAR_VALUE, 1 ) 
        set_engine_par( $ENGINE_PAR_SEND_EFFECT_BYPASS, $replika_delay_bypass_button, -1, 1, $NI_SEND_BUS )
        %bypassed[3] := $replika_delay_bypass_button {Store the bypass state of the replika delay}

        set_control_par( get_ui_id( $psyche_delay_toggle_button ), $CONTROL_PAR_VALUE, 1 ) 
        set_control_par( get_ui_id( $PsycheDelaySettingsPanel ), $CONTROL_PAR_HIDE, $HIDE_PART_NOTHING )

        set_control_par( get_ui_id( $psyche_delay_bypass_button ), $CONTROL_PAR_VALUE, 0 ) 
        set_engine_par( $ENGINE_PAR_SEND_EFFECT_BYPASS, $psyche_delay_bypass_button, -1, 0, $NI_SEND_BUS ) 
        %bypassed[2] := $psyche_delay_bypass_button {Store the bypass state of the psyche delay}
    else
        set_control_par( get_ui_id( $psyche_delay_toggle_button ), $CONTROL_PAR_VALUE, 0 ) 
        set_control_par( get_ui_id( $ReplikaDelaySettingsPanel ), $CONTROL_PAR_HIDE, $HIDE_PART_NOTHING )

        set_control_par( get_ui_id( $replika_delay_bypass_button ), $CONTROL_PAR_VALUE, 0 ) 
        set_engine_par( $ENGINE_PAR_SEND_EFFECT_BYPASS, $replika_delay_bypass_button, -1, 1, $NI_SEND_BUS )
        %bypassed[3] := $replika_delay_bypass_button {Store the bypass state of the replika delay}

        set_control_par( get_ui_id( $PsycheDelaySettingsPanel ), $CONTROL_PAR_HIDE, $HIDE_WHOLE_CONTROL )

        set_control_par( get_ui_id( $psyche_delay_bypass_button ), $CONTROL_PAR_VALUE, 1 )
        set_engine_par( $ENGINE_PAR_SEND_EFFECT_BYPASS, $psyche_delay_bypass_button, -1, 0, $NI_SEND_BUS )
        %bypassed[2] := $psyche_delay_bypass_button {Store the bypass state of the psyche delay}
    end if

    set_control_par( get_ui_id( $effects_bypass_all ), $CONTROL_PAR_VALUE, 0 ) {Reset the bypass all button}

end on

on ui_control( $replika_delay_amount )
    %callback_ids[30] := $NI_CALLBACK_ID
    set_engine_par( $ENGINE_PAR_SEND_EFFECT_OUTPUT_GAIN, $replika_delay_amount, -1, 1, $NI_SEND_BUS )

    set_control_par_str( get_ui_id( $replika_delay_amount ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_SEND_EFFECT_OUTPUT_GAIN, -1, 1, $NI_SEND_BUS ) & " dB" )
    set_control_par_str( get_ui_id( $replika_delay_amount_label ), $CONTROL_PAR_TEXT, "  " & get_engine_par_disp( $ENGINE_PAR_SEND_EFFECT_OUTPUT_GAIN, -1, 1, $NI_SEND_BUS ) & " dB" )

    wait($ui_wait)
    if(%callback_ids[30] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($replika_delay_amount_label), $CONTROL_PAR_TEXT, "AMOUNT")
    end if
end on

on ui_control( $replika_delay_time )
    %callback_ids[31] := $NI_CALLBACK_ID
    set_engine_par( $ENGINE_PAR_RDL_TIME, $replika_delay_time, -1, 1, $NI_SEND_BUS )

    set_control_par_str( get_ui_id( $replika_delay_time ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_RDL_TIME, -1, 1, $NI_SEND_BUS ) & " ms" )
    set_control_par_str( get_ui_id( $replika_delay_time_label ), $CONTROL_PAR_TEXT, get_engine_par_disp( $ENGINE_PAR_RDL_TIME, -1, 1, $NI_SEND_BUS ) & " ms" )

    wait($ui_wait)
    if(%callback_ids[31] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($replika_delay_time_label), $CONTROL_PAR_TEXT, "TIME")
    end if
end on

on ui_control( $replika_delay_feedback )
    %callback_ids[32] := $NI_CALLBACK_ID
    set_engine_par( $ENGINE_PAR_RDL_FEEDBACK, $replika_delay_feedback, -1, 1, $NI_SEND_BUS )

    set_control_par_str( get_ui_id( $replika_delay_feedback ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_RDL_FEEDBACK, -1, 1, $NI_SEND_BUS ) & " %" )
    set_control_par_str( get_ui_id( $replika_delay_feedback_label ), $CONTROL_PAR_TEXT, "    " & get_engine_par_disp( $ENGINE_PAR_RDL_FEEDBACK, -1, 1, $NI_SEND_BUS ) & " %" )

    wait($ui_wait)
    if(%callback_ids[32] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($replika_delay_feedback_label), $CONTROL_PAR_TEXT, "FEEDBACK")
    end if
end on

on ui_control( $replika_delay_depth )
    %callback_ids[33] := $NI_CALLBACK_ID
    set_engine_par( $ENGINE_PAR_RDL_DEPTH, $replika_delay_depth, -1, 1, $NI_SEND_BUS )

    set_control_par_str( get_ui_id( $replika_delay_depth ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_RDL_DEPTH, -1, 1, $NI_SEND_BUS ) & " %" )
    set_control_par_str( get_ui_id( $replika_delay_depth_label ), $CONTROL_PAR_TEXT, " " & get_engine_par_disp( $ENGINE_PAR_RDL_DEPTH, -1, 1, $NI_SEND_BUS ) & " %" )

    wait($ui_wait)
    if(%callback_ids[33] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($replika_delay_depth_label), $CONTROL_PAR_TEXT, "DEPTH")
    end if
end on

on ui_control( $replika_delay_rate )
    %callback_ids[34] := $NI_CALLBACK_ID
    set_engine_par( $ENGINE_PAR_RDL_RATE, $replika_delay_rate, -1, 1, $NI_SEND_BUS )

    set_control_par_str( get_ui_id( $replika_delay_rate ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_RDL_RATE, -1, 1, $NI_SEND_BUS ) & " Hz" )
    set_control_par_str( get_ui_id( $replika_delay_rate_label ), $CONTROL_PAR_TEXT, get_engine_par_disp( $ENGINE_PAR_RDL_RATE, -1, 1, $NI_SEND_BUS ) & " Hz" )

    wait($ui_wait)
    if(%callback_ids[34] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($replika_delay_rate_label), $CONTROL_PAR_TEXT, "RATE")
    end if
end on

on ui_control( $replika_delay_saturation )
    %callback_ids[35] := $NI_CALLBACK_ID
    set_engine_par( $ENGINE_PAR_RDL_SATURATION, $replika_delay_saturation, -1, 1, $NI_SEND_BUS )

    set_control_par_str( get_ui_id( $replika_delay_saturation ), $CONTROL_PAR_LABEL, get_engine_par_disp( $ENGINE_PAR_RDL_SATURATION, -1, 1, $NI_SEND_BUS ) & " %" )
    set_control_par_str( get_ui_id( $replika_delay_saturation_label ), $CONTROL_PAR_TEXT, "      " & get_engine_par_disp( $ENGINE_PAR_RDL_SATURATION, -1, 1, $NI_SEND_BUS ) & " %" )

    wait($ui_wait)
    if(%callback_ids[35] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($replika_delay_saturation_label), $CONTROL_PAR_TEXT, "SATURATION")
    end if
end on

on ui_control( $replika_delay_filter )
    %callback_ids[36] := $NI_CALLBACK_ID
    
    if($replika_delay_filter < 500000)
        set_engine_par( $ENGINE_PAR_RDL_HIGHCUT, $replika_delay_filter * 2, -1, 1, $NI_SEND_BUS )
        set_control_par_str( get_ui_id( $replika_delay_filter ), $CONTROL_PAR_LABEL, "HC " & ((1000000 - $replika_delay_filter * 2) / 10000) & " %" )
        set_control_par_str( get_ui_id( $replika_delay_filter_label ), $CONTROL_PAR_TEXT, "HC " & ((1000000 - $replika_delay_filter * 2) / 10000) & " %" )
    end if
    if($replika_delay_filter > 500000)
        set_engine_par( $ENGINE_PAR_RDL_LOWCUT,  ($replika_delay_filter - 500000) * 2, -1, 1, $NI_SEND_BUS )
        set_control_par_str( get_ui_id( $replika_delay_filter ), $CONTROL_PAR_LABEL, "LC " & ($replika_delay_filter - 500000) * 2 / 10000 & " %" )
        set_control_par_str( get_ui_id( $replika_delay_filter_label ), $CONTROL_PAR_TEXT, "LC " & ($replika_delay_filter - 500000) * 2 / 10000 & " %" )
    end if

    if( $replika_delay_filter = 500000 )
        set_control_par_str( get_ui_id( $replika_delay_filter ), $CONTROL_PAR_LABEL, "Default" )
        set_control_par_str( get_ui_id( $replika_delay_filter_label ), $CONTROL_PAR_TEXT, "Default" )
    end if

    wait($ui_wait)
    if(%callback_ids[36] = $NI_CALLBACK_ID)
        set_control_par_str(get_ui_id($replika_delay_filter_label), $CONTROL_PAR_TEXT, "FILTER")
    end if
end on

on ui_control( $replika_delay_bypass_button )
    set_engine_par( $ENGINE_PAR_SEND_EFFECT_BYPASS, $replika_delay_bypass_button, -1, 1, $NI_SEND_BUS ) 
    %bypassed[3] := $replika_delay_bypass_button {Store the bypass state of the replika delay}

    if( %bypassed[3] = 0 )
        set_control_par( get_ui_id( $effects_bypass_all ), $CONTROL_PAR_VALUE, 0 ) 
    end if
end on





on listener
    if($animation = get_control_par( get_ui_id($animation), $CONTROL_PAR_MAX_VALUE ))
        $animation := 0
    else
        $animation := $animation + 1
    end if
end on 